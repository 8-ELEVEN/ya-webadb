(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[533],{3396:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/scrcpy",function(){return i(2420)}])},2420:function(e,t,i){"use strict";let r,n,o;i.r(t),i.d(t,{default:function(){return e5}});var s,a,l,c,d,h,p,u,g,w,m,v,y,f,b,S,x,P,k,C,D=i(4471),z=i(3922),M=i(9998),j=i(3820),V=i(2252),L=i(9706),E=i(6580),T=i(2952),O=i(4299),I=i(3409),N=i(3499),_=i(3370),U=i(4678),R=i(7893),H=i(4551),B=i(8103),F=function(e){var t=e.className,i=_.useState(function(){return(0,R.z)()})[0],r=e.id,n=void 0===r?i:r,o=_.useRef({hostId:n,rootRef:_.useRef(null),notifyLayersChanged:function(){}});return _.useImperativeHandle(e.componentRef,function(){return o.current}),_.useEffect(function(){(0,B._Y)(n,o.current),(0,B.EQ)(n)},[]),(0,U.k)(function(){(0,B.nw)(n,o.current),(0,B.EQ)(n)}),_.createElement("div",(0,N.pi)({},e,{className:(0,H.i)("ms-LayerHost",t),ref:o.current.rootRef}))},A=i(6054),W=i(8534),G=i(5412),K=i(4373),J=i(9622),q=i(6323),Y=i(6779),Z=i(3538),X=i.n(Z),$=i(7417),Q=i(2469),ee=i(6789),et=i(6261);class ei{adb;options;constructor(e,t){this.adb=e,this.options=t}initialize(){}dispose(){}}class er extends ei{connect(){return this.adb.createSocket("localabstract:scrcpy")}async connectAndRetry(){for(let e=0;e<100;e+=1)try{return await this.connect()}catch(t){await (0,ee.gw)(100)}throw Error("Can't connect to server after 100 retries")}async connectVideoStream(){let{readable:e}=await this.connectAndRetry();if(this.options.sendDummyByte){let t=e.getReader(),{done:i,value:r}=await t.read();if(i||1!==r.byteLength||0!==r[0])throw Error("Unexpected response from server");t.releaseLock()}return e}async getStreams(){let e;let t=await this.connectVideoStream();if(this.options.control&&(e=await this.connectAndRetry()),this.options.sendDeviceMeta){let i=t.getReader(),{done:r,value:n}=await i.read();if(r||68!==n.byteLength)throw Error("Unexpected response from server");i.releaseLock()}return[t,e]}}class en extends ei{streams;address;async initialize(){await this.adb.reverse.remove("localabstract:scrcpy").catch(e=>{});let e=new et.GJ;this.streams=e.readable.getReader();let t=e.writable.getWriter();this.address=await this.adb.reverse.add("localabstract:scrcpy","tcp:27183",e=>(t.write(e),!0))}async accept(){return(await this.streams.read()).value}async getStreams(){let e;let{readable:t}=await this.accept();if(this.options.control&&(e=await this.accept()),this.options.sendDeviceMeta){let i=t.getReader(),{done:r,value:n}=await i.read();if(r||68!==n.byteLength)throw Error("Unexpected response from server");i.releaseLock()}return[t,e]}dispose(){this.adb.reverse.remove(this.address).catch(e=>{})}}class eo{raw;get value(){return this.raw.value}set value(e){this.raw.value=e}constructor(e){this.raw=e}getDefaultValue(){return this.raw.getDefaultValue()}formatServerArguments(){return this.raw.formatServerArguments()}getOutputEncoderNameRegex(){return this.raw.getOutputEncoderNameRegex()}createVideoStreamTransformer(){return this.raw.createVideoStreamTransformer()}getControlMessageTypes(){return this.raw.getControlMessageTypes()}serializeBackOrScreenOnControlMessage(e){return this.raw.serializeBackOrScreenOnControlMessage(e)}serializeInjectScrollControlMessage(e){return this.raw.serializeInjectScrollControlMessage(e)}}class es extends eo{createConnection(e){let t={control:!0,sendDummyByte:!0,sendDeviceMeta:!0};return this.value.tunnelForward?new er(e,t):new en(e,t)}}class ea extends es{createConnection(e){let t={...this.getDefaultValue(),...this.value};return this.value.tunnelForward?new er(e,t):new en(e,t)}}var el=i(9229);(s=m=m||(m={}))[s.InjectKeyCode=0]="InjectKeyCode",s[s.InjectText=1]="InjectText",s[s.InjectTouch=2]="InjectTouch",s[s.InjectScroll=3]="InjectScroll",s[s.BackOrScreenOn=4]="BackOrScreenOn",s[s.ExpandNotificationPanel=5]="ExpandNotificationPanel",s[s.ExpandSettingPanel=6]="ExpandSettingPanel",s[s.CollapseNotificationPanel=7]="CollapseNotificationPanel",s[s.GetClipboard=8]="GetClipboard",s[s.SetClipboard=9]="SetClipboard",s[s.SetScreenPowerMode=10]="SetScreenPowerMode",s[s.RotateDevice=11]="RotateDevice",(a=v=v||(v={}))[a.Down=0]="Down",a[a.Up=1]="Up",(l=y=y||(y={}))[l.Home=3]="Home",l[l.Back=4]="Back",l[l.VolumeUp=24]="VolumeUp",l[l.VolumeDown=25]="VolumeDown",l[l.A=29]="A",l[l.B=30]="B",l[l.C=31]="C",l[l.D=32]="D",l[l.E=33]="E",l[l.F=34]="F",l[l.G=35]="G",l[l.H=36]="H",l[l.I=37]="I",l[l.J=38]="J",l[l.K=39]="K",l[l.L=40]="L",l[l.M=41]="M",l[l.N=42]="N",l[l.O=43]="O",l[l.P=44]="P",l[l.Q=45]="Q",l[l.R=46]="R",l[l.S=47]="S",l[l.T=48]="T",l[l.U=49]="U",l[l.V=50]="V",l[l.W=51]="W",l[l.X=52]="X",l[l.Y=53]="Y",l[l.Z=54]="Z",l[l.Tab=61]="Tab",l[l.Space=62]="Space",l[l.Enter=66]="Enter",l[l.Delete=67]="Delete",l[l.VolumeMute=164]="VolumeMute",l[l.AppSwitch=187]="AppSwitch";let ec=new el.ZP().uint8("type",m.InjectKeyCode).uint8("action",(0,el.W$)()).uint32("keyCode").uint32("repeat").uint32("metaState"),ed=new el.ZP().uint8("type",m.InjectText).uint32("length").string("text",{lengthField:"length"});(c=f=f||(f={}))[c.Down=0]="Down",c[c.Up=1]="Up",c[c.Move=2]="Move",c[c.Cancel=3]="Cancel",c[c.Outside=4]="Outside",c[c.PointerDown=5]="PointerDown",c[c.PointerUp=6]="PointerUp",c[c.HoverMove=7]="HoverMove",c[c.Scroll=8]="Scroll",c[c.HoverEnter=9]="HoverEnter",c[c.HoverExit=10]="HoverExit",c[c.ButtonPress=11]="ButtonPress",c[c.ButtonRelease=12]="ButtonRelease";let eh=new el.ZP().uint8("type",m.InjectTouch).uint8("action",(0,el.W$)()).uint64("pointerId").uint32("pointerX").uint32("pointerY").uint16("screenWidth").uint16("screenHeight").uint16("pressure").uint32("buttons"),ep=new el.ZP().uint8("type",m.RotateDevice);(d=b=b||(b={}))[d.Off=0]="Off",d[d.Normal=2]="Normal";let eu=new el.ZP().uint8("type",m.SetScreenPowerMode).uint8("mode",(0,el.W$)());class eg{options;types;writer;constructor(e,t){this.options=t,this.types=t.getControlMessageTypes(),this.writer=e.getWriter()}getTypeValue(e){let t=this.types.indexOf(e);if(-1===t)throw Error("Not supported");return t}injectKeyCode(e){return this.writer.write(ec.serialize({...e,type:this.getTypeValue(m.InjectKeyCode)}))}injectText(e){return this.writer.write(ed.serialize({text:e,type:this.getTypeValue(m.InjectText)}))}injectTouch(e){return this.writer.write(eh.serialize({...e,type:this.getTypeValue(m.InjectTouch)}))}injectScroll(e){return this.writer.write(this.options.serializeInjectScrollControlMessage({...e,type:this.getTypeValue(m.InjectScroll)}))}async backOrScreenOn(e){let t=this.options.serializeBackOrScreenOnControlMessage({action:e,type:this.getTypeValue(m.BackOrScreenOn)});if(t)return await this.writer.write(t)}setScreenPowerMode(e){return this.writer.write(eu.serialize({mode:e,type:this.getTypeValue(m.SetScreenPowerMode)}))}rotateDevice(){return this.writer.write(ep.serialize({type:this.getTypeValue(m.RotateDevice)}))}close(){return this.writer.close()}}(h=S=S||(S={}))[h.Clipboard=0]="Clipboard",h[h.AckClipboard=1]="AckClipboard";let ew=new el.ZP().uint32("length").string("content",{lengthField:"length"}).extra({type:S.Clipboard});class em extends et.pC{constructor(){super(async e=>{let t=await e.read(1);if(0===t[0])return await ew.deserialize(e);throw Error("unknown control message type")})}}let ev={repeatPreviousFrameAfter:"long",maxPtsGapToEncoder:"long"};class ey{value;constructor(e){this.value=e}toOptionValue(){let e=Object.entries(this.value).filter(([,e])=>void 0!==e);if(0!==e.length)return e.map(([e,t])=>{let i=ev[e];return`${e.replace(/([A-Z])/g,"-$1").toLowerCase()}${i?`:${i}`:""}=${t}`}).join(",")}}let ef="/data/local/tmp/scrcpy-server.jar";function eb(e,t){var i;return void 0===e?t:("object"==typeof(i=e)&&null!==i&&"toOptionValue"in i&&"function"==typeof i.toOptionValue&&(e=e.toOptionValue()),String(e))}class eS{buffer;bytePosition=0;bitPosition=0;constructor(e){this.buffer=e}read(e){let t=0;for(let i=0;i<e;i+=1)t=t<<1|this.next();return t}next(){let e=this.buffer[this.bytePosition]>>7-this.bitPosition&1;return this.bitPosition+=1,8===this.bitPosition&&(this.bytePosition+=1,this.bitPosition=0),e}decodeExponentialGolombNumber(){let e=0;for(;0===this.next();)e+=1;return 0===e?0:(1<<e|this.read(e))-1}}(p=x=x||(x={})).Verbose="verbose",p.Debug="debug",p.Info="info",p.Warn="warn",p.Error="error",(u=P=P||(P={}))[u.Initial=-2]="Initial",u[u.Unlocked=-1]="Unlocked",u[u.Portrait=0]="Portrait",u[u.Landscape=1]="Landscape",u[u.PortraitFlipped=2]="PortraitFlipped",u[u.LandscapeFlipped=3]="LandscapeFlipped";let ex=new el.ZP().uint64("pts").uint32("size").uint8Array("data",{lengthField:"size"}),eP=BigInt(1)<<BigInt(63),ek=new el.ZP().uint8("type",m.BackOrScreenOn),eC=new el.ZP().uint8("type",m.InjectScroll).uint32("pointerX").uint32("pointerY").uint16("screenWidth").uint16("screenHeight").int32("scrollX").int32("scrollY");class eD{value;constructor(e){new.target===eD&&e.logLevel===x.Verbose&&(e.logLevel=x.Debug),new.target===eD&&e.lockVideoOrientation===P.Initial&&(e.lockVideoOrientation=P.Unlocked),this.value=e}getArgumentOrder(){return["logLevel","maxSize","bitRate","maxFps","lockVideoOrientation","tunnelForward","crop","sendFrameMeta","control","displayId","showTouches","stayAwake","codecOptions","encoderName"]}getDefaultValue(){return{logLevel:x.Debug,maxSize:0,bitRate:8e6,maxFps:0,lockVideoOrientation:P.Unlocked,tunnelForward:!1,crop:"-",sendFrameMeta:!0,control:!0,displayId:0,showTouches:!1,stayAwake:!1,codecOptions:new ey({}),encoderName:"-"}}formatServerArguments(){let e=this.getDefaultValue();return this.getArgumentOrder().map(t=>eb(this.value[t]||e[t],"-"))}getOutputEncoderNameRegex(){return/\s+scrcpy --encoder-name '(.*?)'/}createVideoStreamTransformer(){let e;if(!1===this.value.sendFrameMeta)return new et.GJ({transform(e,t){t.enqueue({type:"frame",data:e})}});let t=new et.gL(ex);return{writable:t.writable,readable:t.readable.pipeThrough(new et.GJ({transform(t,i){let r;if(t.pts===eP){let n=function(e){for(let t of function*(e){let t=-1,i=0,r=0,n=!1;for(let o of e){if(e[i]=o,i+=1,n){if(o>3)throw Error("Invalid data");n=!1;continue}if(0==o){r+=1;continue}let s=r;if(r=0,-1===t){if(s>=2&&1===o){i=0,t=0;continue}throw Error("Invalid data")}if(!(s<2)){if(1===o){yield e.subarray(t,i-=s+1),t=i;continue}if(s>2)throw Error("Invalid data");switch(o){case 2:throw Error("Invalid data");case 3:i-=1,n=!0}}}if(n||0!==r)throw Error("Invalid data");yield e.subarray(t,i)}(new Uint8Array(e))){let i,r,n,o;let s=new eS(t);if(0!==s.next())break;let a=s.read(2),l=s.read(5);if(7!==l)continue;if(0===a)break;let c=s.read(8),d=s.read(8),h=new eS(new Uint8Array([d])),p=!!h.next(),u=!!h.next(),g=!!h.next(),w=!!h.next(),m=!!h.next(),v=!!h.next();if(0!==h.read(2))break;let y=s.read(8),f=s.decodeExponentialGolombNumber();if(100===c||110===c||122===c||244===c||44===c||83===c||86===c||118===c||128===c||138===c||139===c||134===c){let b=s.decodeExponentialGolombNumber();3===b&&s.next(),s.decodeExponentialGolombNumber(),s.decodeExponentialGolombNumber(),s.next();let S=!!s.next();if(S){let x=[];for(let P=0;P<(3!==b?8:12);P+=1)x[P]=!!s.next(),x[P]}}s.decodeExponentialGolombNumber();let k=s.decodeExponentialGolombNumber();if(0===k)s.decodeExponentialGolombNumber();else if(1===k){s.next(),s.decodeExponentialGolombNumber(),s.decodeExponentialGolombNumber();let C=s.decodeExponentialGolombNumber(),D=[];for(let z=0;z<C;z+=1)D[z]=s.decodeExponentialGolombNumber()}s.decodeExponentialGolombNumber(),s.next();let M=s.decodeExponentialGolombNumber(),j=s.decodeExponentialGolombNumber(),V=s.next();V||s.next(),s.next();let L=!!s.next();return L?(i=s.decodeExponentialGolombNumber(),r=s.decodeExponentialGolombNumber(),n=s.decodeExponentialGolombNumber(),o=s.decodeExponentialGolombNumber()):(i=0,r=0,n=0,o=0),s.next(),{profile_idc:c,constraint_set:d,constraint_set0_flag:p,constraint_set1_flag:u,constraint_set2_flag:g,constraint_set3_flag:w,constraint_set4_flag:m,constraint_set5_flag:v,level_idc:y,seq_parameter_set_id:f,pic_width_in_mbs_minus1:M,pic_height_in_map_units_minus1:j,frame_mbs_only_flag:V,frame_cropping_flag:L,frame_crop_left_offset:i,frame_crop_right_offset:r,frame_crop_top_offset:n,frame_crop_bottom_offset:o}}throw Error("Invalid data")}(t.data.slice().buffer),{profile_idc:o,constraint_set:s,level_idc:a,pic_width_in_mbs_minus1:l,pic_height_in_map_units_minus1:c,frame_mbs_only_flag:d,frame_crop_left_offset:h,frame_crop_right_offset:p,frame_crop_top_offset:u,frame_crop_bottom_offset:g}=n,w=(l+1)*16,m=(c+1)*(2-d)*16,v=2*h,y=2*p,f=2*u,b=2*g;e=t.data,i.enqueue({type:"configuration",data:{profileIndex:o,constraintSet:s,levelIndex:a,encodedWidth:w,encodedHeight:m,cropLeft:v,cropRight:y,cropTop:f,cropBottom:b,croppedWidth:w-v-y,croppedHeight:m-f-b}});return}e?((r=new Uint8Array(e.byteLength+t.data.byteLength)).set(e),r.set(t.data,e.byteLength),e=void 0):r=t.data,i.enqueue({type:"frame",pts:t.pts,data:r})}}))}}getControlMessageTypes(){return[m.InjectKeyCode,m.InjectText,m.InjectTouch,m.InjectScroll,m.BackOrScreenOn,m.ExpandNotificationPanel,m.CollapseNotificationPanel,m.GetClipboard,m.SetClipboard,m.SetScreenPowerMode,m.RotateDevice]}serializeBackOrScreenOnControlMessage(e){if(e.action===v.Down)return ek.serialize(e)}serializeInjectScrollControlMessage(e){return eC.serialize(e)}}let ez=new el.ZP().fields(ek).uint8("action",(0,el.W$)());class eM extends eD{constructor(e){super(e)}getArgumentOrder(){return super.getArgumentOrder().concat(["powerOffOnClose"])}getDefaultValue(){return{...super.getDefaultValue(),powerOffOnClose:!1}}getOutputEncoderNameRegex(){return/\s+scrcpy --encoder '(.*?)'/}getControlMessageTypes(){let e=super.getControlMessageTypes();return e.splice(6,0,m.ExpandSettingPanel),e}serializeBackOrScreenOnControlMessage(e){return ez.serialize(e)}}class ej extends eM{constructor(e){super(e)}getDefaultValue(){return{...super.getDefaultValue(),clipboardAutosync:!0}}formatServerArguments(){return Object.entries(this.value).map(([e,t])=>[e,eb(t,void 0)]).filter(e=>void 0!==e[1]).map(([e,t])=>`${e.replace(/([A-Z])/g,"_$1").toLowerCase()}=${t}`)}}let eV=new el.ZP().fields(eC).int32("buttons");class eL extends ej{constructor(e){e.rawVideoStream&&(e.sendDeviceMeta=!1,e.sendFrameMeta=!1,e.sendDummyByte=!1),super(e)}getDefaultValue(){return{...super.getDefaultValue(),downsizeOnError:!0,sendDeviceMeta:!0,sendDummyByte:!0,rawVideoStream:!1}}serializeInjectScrollControlMessage(e){return eV.serialize(e)}}let eE=BigInt(1)<<BigInt(62);class eT extends eL{constructor(e){super(e)}getDefaultValue(){return{...super.getDefaultValue(),cleanup:!0}}createVideoStreamTransformer(){let e=super.createVideoStreamTransformer();return{writable:e.writable,readable:e.readable.pipeThrough(new et.GJ({transform(e,t){if("frame"!==e.type){t.enqueue(e);return}void 0!==e.pts&&e.pts&eE&&(e.keyframe=!0,e.pts&=~eE),t.enqueue(e)}}))}}}class eO extends eT{constructor(e){super(e)}getDefaultValue(){return{...super.getDefaultValue(),powerOn:!0}}}class eI extends et.Pz{array;index=0;constructor(e){super({start:async()=>{await Promise.resolve(),this.array=e},pull:e=>{this.index<this.array.length?(e.enqueue(this.array[this.index]),this.index+=1):e.close()}})}}class eN extends et.Pz{streams;index=0;reader;constructor(...e){super({start:async t=>{await Promise.resolve(),this.streams=e,this.advance(t)},pull:async e=>{let t=await this.reader.read();if(!t.done){e.enqueue(t.value);return}this.advance(e)}})}advance(e){this.index<this.streams.length?(this.reader=this.streams[this.index].getReader(),this.index+=1):e.close()}}class e_ extends Error{output;constructor(e){super("scrcpy server exited prematurely"),this.output=e}}class eU{static pushServer(e,t=ef){let i;return new et.BF({start:async()=>(i=await e.sync()).write(t),async close(){await i.dispose()}})}static async start(e,t,i,r){let n;let o=r.createConnection(e);try{await o.initialize(),n=await e.subprocess.spawn([`CLASSPATH=${t}`,"app_process","/","com.genymobile.scrcpy.Server",i,...r.formatServerArguments()],{protocols:[$.vf]});let s=n.stdout.pipeThrough(new et.xU).pipeThrough(new et.Jb("\n")),a=[],l=new et.HS,c=s.pipeTo(new et.Vj({write(e){a.push(e)}}),{signal:l.signal,preventCancel:!0}).catch(e=>{}),d=await Promise.race([n.exit,o.getStreams()]);if("number"==typeof d)throw new e_(a);l.abort(),await c;let[h,p]=d;return new eU(r,n,new eN(new eI(a),s),h,p)}catch(u){throw await n?.kill(),u}finally{o.dispose()}}static async getEncoders(e,t,i,r){Object.assign(r.value,{encoderName:"_",control:!1,sendDeviceMeta:!1,sendDummyByte:!1});let n=await eU.start(e,t,i,r),o=r.getOutputEncoderNameRegex(),s=[];return await n.stdout.pipeTo(new et.Vj({write(e){let t=e.match(o);t&&s.push(t[1])}})),s}static async getDisplays(e,t,i,r){Object.assign(r.value,{displayId:-1,control:!1,sendDeviceMeta:!1,sendDummyByte:!1});try{await eU.start(e,t,i,r)}catch(l){if(l instanceof e_){let n=/\s+scrcpy --display (\d+)/,o=[];for(let s of l.output){let a=s.match(n);a&&o.push(Number.parseInt(a[1],10))}return o}}throw Error("failed to get displays")}process;_stdout;get stdout(){return this._stdout}get exit(){return this.process.exit}_screenWidth;get screenWidth(){return this._screenWidth}_screenHeight;get screenHeight(){return this._screenHeight}_videoStream;get videoStream(){return this._videoStream}_controlMessageSerializer;get controlMessageSerializer(){return this._controlMessageSerializer}_deviceMessageStream;get deviceMessageStream(){return this._deviceMessageStream}constructor(e,t,i,r,n){this.process=t,this._stdout=i,this._videoStream=r.pipeThrough(e.createVideoStreamTransformer()).pipeThrough(new et.N7(e=>{"configuration"===e.type&&(this._screenWidth=e.data.croppedWidth,this._screenHeight=e.data.croppedHeight)})),n&&(this._controlMessageSerializer=new eg(n.writable,e),this._deviceMessageStream=n.readable.pipeThrough(new em))}async close(){await this.process.kill()}}(g=k=k||(k={}))[g.Baseline=1]="Baseline",g[g.Main=2]="Main",g[g.Extended=4]="Extended",g[g.High=8]="High",g[g.High10=16]="High10",g[g.High422=32]="High422",g[g.High444=64]="High444",g[g.ConstrainedBaseline=65536]="ConstrainedBaseline",g[g.ConstrainedHigh=524288]="ConstrainedHigh",(w=C=C||(C={}))[w.Level1=1]="Level1",w[w.Level1b=2]="Level1b",w[w.Level11=4]="Level11",w[w.Level12=8]="Level12",w[w.Level13=16]="Level13",w[w.Level2=32]="Level2",w[w.Level21=64]="Level21",w[w.Level22=128]="Level22",w[w.Level3=256]="Level3",w[w.Level31=512]="Level31",w[w.Level32=1024]="Level32",w[w.Level4=2048]="Level4",w[w.Level41=4096]="Level41",w[w.Level42=8192]="Level42",w[w.Level5=16384]="Level5",w[w.Level51=32768]="Level51",w[w.Level52=65536]="Level52",w[w.Level6=131072]="Level6",w[w.Level61=262144]="Level61",w[w.Level62=524288]="Level62";let eR=!1,eH=[],eB=0,eF=new Map;class eA extends Q.Xn{streamId;pictureReadyEvent=new Q.vp;get onPictureReady(){return this.pictureReadyEvent.event}constructor(e){var t;super(),this.streamId=e,this.addDisposable((t=this.handlePictureReady,eF.set(e,t),{dispose(){eF.delete(e)}}))}handlePictureReady=e=>{this.pictureReadyEvent.fire(e)};feed(e){r.postMessage({type:"decode",data:e,offset:0,length:e.byteLength,renderStateId:this.streamId},[e])}dispose(){super.dispose(),r.postMessage({type:"release",renderStateId:this.streamId})}}function eW(){return n||(n=Promise.all([i.e(118).then(i.t.bind(i,6118,19)),i.e(337).then(i.t.bind(i,6337,19))]).then(([e,{default:t}])=>({YuvBuffer:e,YuvCanvas:t}))),n}class eG{maxProfile=k.Baseline;maxLevel=C.Level4;_renderer;get renderer(){return this._renderer}_frameRendered=0;get frameRendered(){return this._frameRendered}_writable;get writable(){return this._writable}_yuvCanvas;_initializer;constructor(){eW(),this._renderer=document.createElement("canvas"),this._writable=new et.Vj({write:async e=>{switch(e.type){case"configuration":this.configure(e.data);break;case"frame":{if(!this._initializer)throw Error("Decoder not configured");let t=await this._initializer.promise;t.feed(e.data.slice().buffer)}}}})}async configure(e){this.dispose(),this._initializer=new ee.hP;let{YuvBuffer:t,YuvCanvas:n}=await eW();this._yuvCanvas||(this._yuvCanvas=n.attach(this._renderer));let{encodedWidth:o,encodedHeight:s}=e,a=o/2,l=s/2;this._renderer.width=e.croppedWidth,this._renderer.height=e.croppedHeight;let c=t.format({width:o,height:s,chromaWidth:a,chromaHeight:l,cropLeft:e.cropLeft,cropTop:e.cropTop,cropWidth:e.croppedWidth,cropHeight:e.croppedHeight,displayWidth:e.croppedWidth,displayHeight:e.croppedHeight}),d=await function(){if(r||(r=new Worker(i.tu(new URL(i.p+i.u(292),i.b)))).addEventListener("message",({data:e})=>{switch(e.type){case"decoderReady":for(let t of(eR=!0,eH))t.resolve(new eA(eB)),eB+=1;eH.length=0;break;case"pictureReady":eF.get(e.renderStateId)?.(e)}}),!eR){let e=new ee.hP;return eH.push(e),e.promise}let t=new eA(eB);return eB+=1,Promise.resolve(t)}();this._initializer.resolve(d);let h=o*s,p=h+a*l;d.onPictureReady(({data:e})=>{this._frameRendered+=1;let i=new Uint8Array(e),r=t.frame(c,t.lumaPlane(c,i,o,0),t.chromaPlane(c,i,a,h),t.chromaPlane(c,i,a,p));this._yuvCanvas.drawFrame(r)})}dispose(){this._initializer?.promise.then(e=>e.dispose()).catch(e=>{}),this._initializer=void 0}}function eK(e){return e.toString(16).padStart(2,"0").toUpperCase()}class eJ{maxProfile=void 0;maxLevel=void 0;_writable;get writable(){return this._writable}_renderer;get renderer(){return this._renderer}_frameRendered=0;get frameRendered(){return this._frameRendered}context;decoder;lastFrame;animationFrame=0;constructor(){this._renderer=document.createElement("canvas"),this.context=this._renderer.getContext("2d"),this.decoder=new VideoDecoder({output:e=>{this.lastFrame&&this.lastFrame.close(),this.lastFrame=e,this.animationFrame||this.render()},error(e){}}),this._writable=new et.Vj({write:e=>{switch(e.type){case"configuration":this.configure(e.data);break;case"frame":this.decoder.decode(new EncodedVideoChunk({type:!1===e.keyframe?"delta":"key",timestamp:0,data:e.data}))}}})}render=()=>{this.lastFrame&&(this._frameRendered+=1,this.context.drawImage(this.lastFrame,0,0),this.lastFrame.close(),this.lastFrame=void 0),this.animationFrame=requestAnimationFrame(this.render)};configure(e){let{profileIndex:t,constraintSet:i,levelIndex:r}=e;this._renderer.width=e.croppedWidth,this._renderer.height=e.croppedHeight;let n=`avc1.${[t,i,r].map(eK).join("")}`;this.decoder.configure({codec:n,optimizeForLatency:!0})}dispose(){cancelAnimationFrame(this.animationFrame),this.decoder.close()}}var eq="1.24",eY=i(5431),eZ=i(6606),eX=i(4051);let e$=new i.U(i(4439));class eQ{get downloaded(){return this._downloaded}get total(){return this._total}get onProgress(){return this.progressEvent.event}async fetch(e){var t;let i=await window.fetch(e);this._total=Number.parseInt(null!==(t=i.headers.get("Content-Length"))&&void 0!==t?t:"0",10),this.progressEvent.fire([this._downloaded,this._total]);let r=i.body.getReader(),n=[];for(;;){let o=await r.read();if(o.done)break;n.push(o.value),this._downloaded+=o.value.byteLength,this.progressEvent.fire([this._downloaded,this._total])}this._total=n.reduce((e,t)=>e+t.byteLength,0);let s=new Uint8Array(this._total),a=0;for(let l of n)s.set(l,a),a+=l.byteLength;return s}constructor(e){this._downloaded=0,this._total=0,this.progressEvent=new Q.vp,this.promise=this.fetch(e)}}function e0(e){return o||(o=new eQ(e$)).promise.catch(e=>{o=void 0}),e&&(o.onProgress(e),e([o.downloaded,o.total])),o.promise}let e1=(0,J.Z)({labelRight:{marginLeft:"4px"},video:{transformOrigin:"center center"}}),e2=(0,Y.Pi)(function(e){let{definition:t,settings:i,onChange:r}=e,n=e1(),o=(0,D.jsxs)(z.K,{horizontal:!0,verticalAlign:"center",children:[(0,D.jsx)("span",{children:t.label}),!!t.description&&(0,D.jsx)(M.G,{content:t.description,children:(0,D.jsx)(j.J,{className:n.labelRight,iconName:eX.PJ.Info})}),t.labelExtra]});switch(t.type){case"text":return(0,D.jsx)(V.n,{label:o,placeholder:t.placeholder,value:i[t.key],onChange:(e,i)=>r(t.key,i)});case"dropdown":return(0,D.jsx)(L.L,{label:o,options:t.options,placeholder:t.placeholder,selectedKey:i[t.key],onChange:(e,i)=>r(t.key,i.key)});case"toggle":return(0,D.jsx)(E.Z,{label:o,checked:i[t.key],onChange:(e,i)=>r(t.key,i)});case"number":return(0,D.jsx)(T.k,{label:t.label,labelPosition:O.L.top,min:t.min,max:t.max,step:t.step,value:i[t.key].toString(),onChange:(e,i)=>r(t.key,Number.parseInt(i,10))})}}),e3=new class{get rotatedWidth(){return 1&e3.rotate?e3.height:e3.width}get rotatedHeight(){return 1&e3.rotate?e3.width:e3.height}async pushServer(){let e=await e0();await new et.Pz({start(t){t.enqueue(e),t.close()}}).pipeTo(eU.pushServer(eZ.q.device))}get commandBarItems(){let e=[];return this.running?e.push({key:"stop",iconProps:{iconName:eX.PJ.Stop},text:"Stop",onClick:this.stop}):e.push({key:"start",disabled:!eZ.q.device,iconProps:{iconName:eX.PJ.Play},text:"Start",onClick:this.start}),e.push({key:"fullscreen",disabled:!this.running,iconProps:{iconName:eX.PJ.FullScreenMaximize},iconOnly:!0,text:"Fullscreen",onClick:()=>{var e;null===(e=this.deviceView)||void 0===e||e.enterFullscreen()}}),e.push({key:"volumeUp",disabled:!this.running,iconProps:{iconName:eX.PJ.Speaker2},iconOnly:!0,text:"Volume Up",onClick:async()=>{var e,t;await (null===(e=this.client)||void 0===e?void 0:e.controlMessageSerializer.injectKeyCode({action:v.Down,keyCode:y.VolumeUp,repeat:0,metaState:0})),await (null===(t=this.client)||void 0===t?void 0:t.controlMessageSerializer.injectKeyCode({action:v.Up,keyCode:y.VolumeUp,repeat:0,metaState:0}))}},{key:"volumeDown",disabled:!this.running,iconProps:{iconName:eX.PJ.Speaker1},iconOnly:!0,text:"Volume Down",onClick:async()=>{var e,t;await (null===(e=this.client)||void 0===e?void 0:e.controlMessageSerializer.injectKeyCode({action:v.Down,keyCode:y.VolumeDown,repeat:0,metaState:0})),await (null===(t=this.client)||void 0===t?void 0:t.controlMessageSerializer.injectKeyCode({action:v.Up,keyCode:y.VolumeDown,repeat:0,metaState:0}))}},{key:"volumeMute",disabled:!this.running,iconProps:{iconName:eX.PJ.SpeakerOff},iconOnly:!0,text:"Toggle Mute",onClick:async()=>{var e,t;await (null===(e=this.client)||void 0===e?void 0:e.controlMessageSerializer.injectKeyCode({action:v.Down,keyCode:y.VolumeMute,repeat:0,metaState:0})),await (null===(t=this.client)||void 0===t?void 0:t.controlMessageSerializer.injectKeyCode({action:v.Up,keyCode:y.VolumeMute,repeat:0,metaState:0}))}}),e.push({key:"rotateDevice",disabled:!this.running,iconProps:{iconName:eX.PJ.Orientation},iconOnly:!0,text:"Rotate Device",onClick:()=>{this.client.controlMessageSerializer.rotateDevice()}},{key:"rotateVideoLeft",disabled:!this.running,iconProps:{iconName:eX.PJ.RotateLeft},iconOnly:!0,text:"Rotate Video Left",onClick:(0,q.aD)(()=>{this.rotate-=1,this.rotate<0&&(this.rotate=3)})},{key:"rotateVideoRight",disabled:!this.running,iconProps:{iconName:eX.PJ.RotateRight},iconOnly:!0,text:"Rotate Video Right",onClick:(0,q.aD)(()=>{this.rotate=this.rotate+1&3})}),e.push({key:"turnScreenOff",disabled:!this.running,iconProps:{iconName:eX.PJ.Lightbulb},iconOnly:!0,text:"Turn Screen Off",onClick:()=>{this.client.controlMessageSerializer.setScreenPowerMode(b.Off)}},{key:"turnScreenOn",disabled:!this.running,iconProps:{iconName:eX.PJ.LightbulbFilament},iconOnly:!0,text:"Turn Screen On",onClick:()=>{this.client.controlMessageSerializer.setScreenPowerMode(b.Normal)}}),this.running&&e.push({key:"fps",text:"FPS: ".concat(this.fps),disabled:!0}),e}get commandBarFarItems(){return[{key:"NavigationBar",iconProps:{iconName:eX.PJ.PanelBottom},checked:this.navigationBarVisible,text:"Navigation Bar",iconOnly:!0,onClick:(0,q.aD)(()=>{this.navigationBarVisible=!this.navigationBarVisible})},{key:"Log",iconProps:{iconName:eX.PJ.TextGrammarError},checked:this.logVisible,text:"Log",iconOnly:!0,onClick:(0,q.aD)(()=>{this.logVisible=!this.logVisible})},{key:"Settings",iconProps:{iconName:eX.PJ.Settings},checked:this.settingsVisible,text:"Settings",iconOnly:!0,onClick:(0,q.aD)(()=>{this.settingsVisible=!this.settingsVisible})},{key:"DemoMode",iconProps:{iconName:eX.PJ.Wand},checked:this.demoModeVisible,text:"Demo Mode",iconOnly:!0,onClick:(0,q.aD)(()=>{this.demoModeVisible=!this.demoModeVisible})},{key:"info",iconProps:{iconName:eX.PJ.Info},iconOnly:!0,tooltipHostProps:{content:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("p",{children:[(0,D.jsx)(eY.dL,{href:"https://github.com/Genymobile/scrcpy",spaceAfter:!0,children:"Scrcpy"}),"developed by Genymobile can display the screen with low latency (1~2 frames) and control the device, all without root access."]}),(0,D.jsx)("p",{children:"This is a TypeScript implementation of the client part. Paired with official pre-built server binary."})]}),calloutProps:{calloutMaxWidth:300}}}]}get settingDefinitions(){let e=[];return e.push({key:"powerOn",type:"toggle",label:"Turn device on when starting"},{key:"turnScreenOff",type:"toggle",label:"Turn screen off when starting"},{key:"stayAwake",type:"toggle",label:"Stay awake (if plugged in)"},{key:"powerOffOnClose",type:"toggle",label:"Turn device off when exiting"}),e.push({key:"displayId",type:"dropdown",label:"Display",placeholder:"Press refresh to update available displays",labelExtra:(0,D.jsx)(I.h,{iconProps:{iconName:eX.PJ.ArrowClockwise},disabled:!eZ.q.device,text:"Refresh",onClick:this.updateDisplays}),options:this.displays.map(e=>({key:e,text:e.toString()}))}),e.push({key:"crop",type:"text",label:"Crop",placeholder:"W:H:X:Y"}),e.push({key:"maxSize",type:"number",label:"Max Resolution (longer side, 0 = unlimited)",min:0,max:2560,step:50}),e.push({key:"bitRate",type:"number",label:"Max Bit Rate",min:100,max:1e8,step:100}),e.push({key:"lockVideoOrientation",type:"dropdown",label:"Lock Video Orientation",options:[{key:P.Unlocked,text:"Unlocked"},{key:P.Initial,text:"Current"},{key:P.Portrait,text:"Portrait"},{key:P.Landscape,text:"Landscape"},{key:P.PortraitFlipped,text:"Portrait (Flipped)"},{key:P.LandscapeFlipped,text:"Landscape (Flipped)"}]}),e.push({key:"encoderName",type:"dropdown",label:"Encoder",placeholder:"Press refresh to update available encoders",labelExtra:(0,D.jsx)(I.h,{iconProps:{iconName:eX.PJ.ArrowClockwise},disabled:!eZ.q.device,text:"Refresh",onClick:this.updateEncoders}),options:this.encoders.map(e=>({key:e,text:e}))}),this.decoders.length>1&&e.push({key:"decoder",type:"dropdown",label:"Decoder",options:this.decoders.map(e=>({key:e.key,text:e.name,data:e}))}),e.push({key:"ignoreDecoderCodecArgs",type:"toggle",label:"Ignore decoder's codec arguments",description:"Some decoders don't support all H.264 profile/levels, so they request the device to encode at their highest-supported codec. However, some super old devices may not support that codec so their encoders will fail to start. Use this option to let device choose the codec to be used."}),e.push({key:"tunnelForward",type:"toggle",label:"Use forward connection",description:"Android before version 9 has a bug that prevents reverse tunneling when using ADB over WiFi."}),e}async stop(){var e;await (null===(e=this.client)||void 0===e?void 0:e.close()),this.dispose()}dispose(){var e;null===(e=this.decoder)||void 0===e||e.dispose(),this.decoder=void 0,this.fps=0,clearTimeout(this.fpsCounterIntervalId),this.client=void 0,this.running=!1}handleDeviceViewRef(e){this.deviceView=e}handleRendererContainerRef(e){var t;this.rendererContainer=e,null===(t=this.rendererContainer)||void 0===t||t.addEventListener("wheel",this.handleWheel,{passive:!1})}calculatePointerPosition(e,t){var i,r;let n=this.rendererContainer.getBoundingClientRect(),o=(i=(e-n.x)/n.width)<0?0:i>1?1:i,s=(r=(t-n.y)/n.height)<0?0:r>1?1:r;switch(1&this.rotate&&([o,s]=[s,o]),this.rotate){case 1:s=1-s;break;case 2:o=1-o,s=1-s;break;case 3:o=1-o}return{x:o*this.width,y:s*this.height}}constructor(){this.running=!1,this.deviceView=null,this.rendererContainer=null,this.logVisible=!1,this.log=[],this.settingsVisible=!1,this.demoModeVisible=!1,this.navigationBarVisible=!0,this.width=0,this.height=0,this.rotate=0,this.client=void 0,this.encoders=[],this.updateEncoders=async()=>{try{await this.pushServer();let e=await eU.getEncoders(eZ.q.device,ef,eq,new ea(new eO({logLevel:x.Debug,tunnelForward:this.settings.tunnelForward})));(0,q.z)(()=>{this.encoders=e,this.settings.encoderName&&this.encoders.includes(this.settings.encoderName)||(this.settings.encoderName=this.encoders[0])})}catch(t){eZ.q.showErrorDialog(t)}},this.decoders=[{key:"tinyh264",name:"TinyH264 (Software)",Constructor:eG}],this.decoder=void 0,this.fpsCounterIntervalId=void 0,this.fps=0,this.displays=[],this.updateDisplays=async()=>{try{await this.pushServer();let e=await eU.getDisplays(eZ.q.device,ef,eq,new ea(new eO({logLevel:x.Debug,tunnelForward:this.settings.tunnelForward})));(0,q.z)(()=>{this.displays=e,this.settings.displayId&&this.displays.includes(this.settings.displayId)||(this.settings.displayId=this.displays[0])})}catch(t){eZ.q.showErrorDialog(t)}},this.connecting=!1,this.serverTotalSize=0,this.serverDownloadedSize=0,this.debouncedServerDownloadedSize=0,this.serverDownloadSpeed=0,this.serverUploadedSize=0,this.debouncedServerUploadedSize=0,this.serverUploadSpeed=0,this.settings={maxSize:1080,bitRate:4e6,lockVideoOrientation:P.Unlocked,displayId:0,crop:"",powerOn:!0},this.start=async()=>{if(eZ.q.device)try{var e;let t;if(!this.settings.decoder)throw Error("No available decoder");(0,q.z)(()=>{this.serverTotalSize=0,this.serverDownloadedSize=0,this.debouncedServerDownloadedSize=0,this.serverUploadedSize=0,this.debouncedServerUploadedSize=0,this.connecting=!0});let i=setInterval((0,q.aD)(()=>{this.serverDownloadSpeed=this.serverDownloadedSize-this.debouncedServerDownloadedSize,this.debouncedServerDownloadedSize=this.serverDownloadedSize}),1e3);try{t=await e0((0,q.aD)(e=>{let[t,i]=e;this.serverDownloadedSize=t,this.serverTotalSize=i})),(0,q.z)(()=>{this.serverDownloadSpeed=this.serverDownloadedSize-this.debouncedServerDownloadedSize,this.debouncedServerDownloadedSize=this.serverDownloadedSize})}finally{clearInterval(i)}i=setInterval((0,q.aD)(()=>{this.serverUploadSpeed=this.serverUploadedSize-this.debouncedServerUploadedSize,this.debouncedServerUploadedSize=this.serverUploadedSize}),1e3);try{await new et.Pz({start(e){e.enqueue(t),e.close()}}).pipeThrough(new et.Cc($.j4)).pipeThrough(new eX.hK((0,q.aD)(e=>{this.serverUploadedSize=e}))).pipeTo(eU.pushServer(eZ.q.device)),(0,q.z)(()=>{this.serverUploadSpeed=this.serverUploadedSize-this.debouncedServerUploadedSize,this.debouncedServerUploadedSize=this.serverUploadedSize})}finally{clearInterval(i)}let r=null!==(e=this.decoders.find(e=>e.key===this.settings.decoder))&&void 0!==e?e:this.decoders[0],n=new r.Constructor;(0,q.z)(()=>{this.decoder=n;let e=0;this.fpsCounterIntervalId=setInterval((0,q.aD)(()=>{this.fps=n.frameRendered-e,e=n.frameRendered}),1e3)});let o=new ea(new eO({logLevel:x.Debug,...this.settings,sendDeviceMeta:!1,sendDummyByte:!1,codecOptions:this.settings.ignoreDecoderCodecArgs?void 0:new ey({profile:n.maxProfile,level:n.maxLevel})}));(0,q.z)(()=>{this.log=[],this.log.push("[client] Server version: ".concat(eq)),this.log.push("[client] Server arguments: ".concat(o.formatServerArguments().join(" ")))});let s=await eU.start(eZ.q.device,ef,eq,o);s.stdout.pipeTo(new et.Vj({write:(0,q.aD)(e=>{this.log.push(e)})})),s.videoStream.pipeThrough(new et.N7((0,q.aD)(e=>{if("configuration"===e.type){let{croppedWidth:t,croppedHeight:i}=e.data;this.log.push("[client] Video size changed: ".concat(t,"x").concat(i)),this.width=t,this.height=i}}))).pipeTo(n.writable).catch(()=>{}),s.exit.then(this.dispose),s.deviceMessageStream.pipeTo(new et.Vj({write(e){e.type===S.Clipboard&&window.navigator.clipboard.writeText(e.content)}})).catch(()=>{}),this.settings.turnScreenOff&&await s.controlMessageSerializer.setScreenPowerMode(b.Off),(0,q.z)(()=>{this.client=s,this.running=!0})}catch(a){eZ.q.showErrorDialog(a)}finally{(0,q.z)(()=>{this.connecting=!1})}},this.handleBackPointerDown=e=>{this.client&&0===e.button&&(e.currentTarget.setPointerCapture(e.pointerId),this.client.controlMessageSerializer.backOrScreenOn(v.Down))},this.handleBackPointerUp=e=>{this.client&&0===e.button&&this.client.controlMessageSerializer.backOrScreenOn(v.Up)},this.handleHomePointerDown=e=>{this.client&&0===e.button&&(e.currentTarget.setPointerCapture(e.pointerId),this.client.controlMessageSerializer.injectKeyCode({action:v.Down,keyCode:y.Home,repeat:0,metaState:0}))},this.handleHomePointerUp=e=>{this.client&&0===e.button&&this.client.controlMessageSerializer.injectKeyCode({action:v.Up,keyCode:y.Home,repeat:0,metaState:0})},this.handleAppSwitchPointerDown=async e=>{this.client&&0===e.button&&(e.currentTarget.setPointerCapture(e.pointerId),this.client.controlMessageSerializer.injectKeyCode({action:v.Down,keyCode:y.AppSwitch,repeat:0,metaState:0}))},this.handleAppSwitchPointerUp=async e=>{this.client&&0===e.button&&this.client.controlMessageSerializer.injectKeyCode({action:v.Up,keyCode:y.AppSwitch,repeat:0,metaState:0})},this.injectTouch=(e,t)=>{if(!this.client)return;let{x:i,y:r}=this.calculatePointerPosition(t.clientX,t.clientY);this.client.controlMessageSerializer.injectTouch({action:e,pointerId:"mouse"===t.pointerType?BigInt(-1):BigInt(t.pointerId),screenWidth:this.client.screenWidth,screenHeight:this.client.screenHeight,pointerX:i,pointerY:r,pressure:65535*t.pressure,buttons:t.buttons})},this.handlePointerDown=e=>{this.rendererContainer.focus(),e.preventDefault(),e.currentTarget.setPointerCapture(e.pointerId),this.injectTouch(f.Down,e)},this.handlePointerMove=e=>{this.injectTouch(0===e.buttons?f.HoverMove:f.Move,e)},this.handlePointerUp=e=>{this.injectTouch(f.Up,e)},this.handleWheel=e=>{if(!this.client)return;e.preventDefault(),e.stopPropagation();let{x:t,y:i}=this.calculatePointerPosition(e.clientX,e.clientY);this.client.controlMessageSerializer.injectScroll({screenWidth:this.client.screenWidth,screenHeight:this.client.screenHeight,pointerX:t,pointerY:i,scrollX:-Math.sign(e.deltaX),scrollY:-Math.sign(e.deltaY),buttons:0})},this.handleContextMenu=e=>{e.preventDefault()},this.handleKeyDown=async e=>{if(!this.client)return;let{key:t,code:i}=e;if(t.match(/^[!-`{-~]$/i)){this.client.controlMessageSerializer.injectText(t);return}let r={Backspace:y.Delete,Space:y.Space,Enter:y.Enter}[i];r&&(this.client.controlMessageSerializer.injectKeyCode({action:v.Down,keyCode:r,metaState:0,repeat:0}),this.client.controlMessageSerializer.injectKeyCode({action:v.Up,keyCode:r,metaState:0,repeat:0}))},(0,q.ky)(this,{decoders:q.LO.shallow,settings:q.LO.deep,start:!1,stop:q.aD.bound,dispose:q.aD.bound,handleDeviceViewRef:q.aD.bound,handleRendererContainerRef:q.aD.bound,handleBackPointerDown:!1,handleBackPointerUp:!1,handleHomePointerDown:!1,handleHomePointerUp:!1,handleAppSwitchPointerDown:!1,handleAppSwitchPointerUp:!1,calculatePointerPosition:!1,injectTouch:!1,handlePointerDown:!1,handlePointerMove:!1,handlePointerUp:!1,handleWheel:!1,handleContextMenu:!1,handleKeyDown:!1}),(0,q.EH)(()=>{eZ.q.device?(0,q.z)(()=>{this.encoders=[],this.settings.encoderName=void 0,this.displays=[],this.settings.displayId=void 0}):this.dispose()}),(0,q.EH)(()=>{if(this.rendererContainer&&this.decoder){for(;this.rendererContainer.firstChild;)this.rendererContainer.firstChild.remove();this.rendererContainer.appendChild(this.decoder.renderer)}}),(0,q.EH)(()=>{this.settings.decoder=this.decoders[0].key}),"function"==typeof window.VideoDecoder&&setTimeout((0,q.aD)(()=>{this.decoders.unshift({key:"webcodecs",name:"WebCodecs",Constructor:eJ})}),0)}},e4=(0,Y.Pi)(()=>{let e=(0,K.M)("layerHost"),[t,i]=(0,_.useState)(!1);return((0,_.useEffect)(()=>{i(!0)},[]),t)?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(F,{id:e,style:{position:"absolute",top:0,bottom:0,left:0,right:0,margin:0,pointerEvents:"none"}}),(0,D.jsx)(A.V,{hidden:!e3.connecting,modalProps:{layerProps:{hostId:e}},dialogContentProps:{title:"Connecting..."},children:(0,D.jsxs)(z.K,{tokens:eX.WT,children:[(0,D.jsx)(W.Y,{label:"1. Downloading scrcpy server...",percentComplete:e3.serverTotalSize?e3.serverDownloadedSize/e3.serverTotalSize:void 0,description:(0,eX.CY)(e3.debouncedServerDownloadedSize,e3.serverTotalSize,e3.serverDownloadSpeed)}),(0,D.jsx)(W.Y,{label:"2. Pushing scrcpy server to device...",progressHidden:0===e3.serverTotalSize||e3.serverDownloadedSize!==e3.serverTotalSize,percentComplete:e3.serverUploadedSize/e3.serverTotalSize,description:(0,eX.CY)(e3.debouncedServerUploadedSize,e3.serverTotalSize,e3.serverUploadSpeed)}),(0,D.jsx)(W.Y,{label:"3. Starting scrcpy server on device...",progressHidden:0===e3.serverTotalSize||e3.serverUploadedSize!==e3.serverTotalSize})]})})]}):null}),e6=(0,Y.Pi)(function(e){let{className:t,style:i,children:r}=e;return e3.navigationBarVisible?(0,D.jsxs)(z.K,{className:t,verticalFill:!0,horizontalAlign:"center",style:{height:"40px",background:"#999",...i},children:[r,(0,D.jsxs)(z.K,{verticalFill:!0,horizontal:!0,style:{width:"100%",maxWidth:300},horizontalAlign:"space-evenly",verticalAlign:"center",children:[(0,D.jsx)(I.h,{iconProps:{iconName:eX.PJ.Play},style:{transform:"rotate(180deg)",color:"white"},onPointerDown:e3.handleBackPointerDown,onPointerUp:e3.handleBackPointerUp}),(0,D.jsx)(I.h,{iconProps:{iconName:eX.PJ.Circle},style:{color:"white"},onPointerDown:e3.handleHomePointerDown,onPointerUp:e3.handleHomePointerUp}),(0,D.jsx)(I.h,{iconProps:{iconName:eX.PJ.Stop},style:{color:"white"},onPointerDown:e3.handleAppSwitchPointerDown,onPointerUp:e3.handleAppSwitchPointerUp})]})]}):(0,D.jsx)("div",{className:t,style:i,children:r})}),e8=()=>{let e=e1();return(0,D.jsxs)(z.K,{...eX.LE,children:[(0,D.jsx)(X(),{children:(0,D.jsx)("title",{children:"Scrcpy - Android Web Toolbox"})}),(0,D.jsx)(G.X,{items:e3.commandBarItems,farItems:e3.commandBarFarItems}),(0,D.jsxs)(z.K,{horizontal:!0,grow:!0,styles:{root:{height:0}},children:[(0,D.jsx)(eY.wM,{ref:e3.handleDeviceViewRef,width:e3.rotatedWidth,height:e3.rotatedHeight,BottomElement:e6,children:(0,D.jsx)("div",{ref:e3.handleRendererContainerRef,tabIndex:-1,className:e.video,style:{width:e3.width,height:e3.height,transform:"translate(".concat((e3.rotatedWidth-e3.width)/2,"px, ").concat((e3.rotatedHeight-e3.height)/2,"px) rotate(").concat(90*e3.rotate,"deg)")},onPointerDown:e3.handlePointerDown,onPointerMove:e3.handlePointerMove,onPointerUp:e3.handlePointerUp,onPointerCancel:e3.handlePointerUp,onKeyDown:e3.handleKeyDown,onContextMenu:e3.handleContextMenu})}),(0,D.jsx)("div",{style:{padding:12,overflow:"hidden auto",display:e3.logVisible?"block":"none",width:500,fontFamily:"monospace",overflowY:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word"},children:e3.log.map((e,t)=>(0,D.jsx)("div",{children:e},t))}),(0,D.jsxs)("div",{style:{padding:12,overflow:"hidden auto",display:e3.settingsVisible?"block":"none",width:300},children:[(0,D.jsx)("div",{children:"Changes will take effect on next connection"}),e3.settingDefinitions.map(e=>(0,D.jsx)(e2,{definition:e,settings:e3.settings,onChange:(0,q.aD)((e,t)=>e3.settings[e]=t)},e.key))]}),(0,D.jsx)(eY.bq,{style:{display:e3.demoModeVisible?"block":"none"}}),(0,D.jsx)(e4,{})]})]})};var e5=(0,Y.Pi)(e8)},4439:function(e,t,i){"use strict";e.exports=i.p+"static/chunks/scrcpy-server.d406f4d14066a1d3"}},function(e){e.O(0,[252,774,888,179],function(){return e(e.s=3396)}),_N_E=e.O()}]);
//# sourceMappingURL=scrcpy-7d8db3a8b777dfb1.js.map