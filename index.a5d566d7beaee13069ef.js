!function(e){function t(t){for(var r,s,o=t[0],c=t[1],l=t[2],u=0,h=[];u<o.length;u++)s=o[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(d&&d(t);h.length;)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={0:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=c;a.push(["2YZa",1]),n()}({"2YZa":function(e,t,n){"use strict";n.r(t);var r=n("bBLm"),i=n("D2wA"),a=n("hR4L"),s=n("78K9"),o=n("LDcz"),c=n("3mns"),l=n("GIx+"),d=n("uqg9"),u=n("iMux"),h=n("CcL7"),f=n("gTkT"),m=n("fGTi"),p=n("q1tI"),v=n.n(p),b=n("i8i4"),y=n.n(b),g=n("Ty5D"),w=n("55Ip"),E=n("sByA"),k=n("Ypxj"),O=n("ypaI"),j=n("ZZCj"),D=n("sGVl"),C=n("jEFs"),S=n("LUf3"),A=n("+glh"),x=n.n(A),_=n("qHjL");class U{constructor(){this.listeners=[],this.event=this.event.bind(this)}event(e,t,...n){const r={listener:e,thisArg:t,args:n};this.listeners.push(r);const i=()=>{const e=this.listeners.indexOf(r);e>0&&this.listeners.splice(e,1)};return i.dispose=i,i}fire(e){for(const t of this.listeners.slice())t.listener.apply(t.thisArg,[e,...t.args])}dispose(){this.listeners.length=0}}class I extends U{fire(e){return Object(_.a)(this,void 0,void 0,(function*(){for(const t of this.listeners)yield t.listener.apply(t.thisArg,[e,...t.args])}))}}class L{constructor(){this.disposables=[]}addDisposable(e){return this.disposables.push(e),e}dispose(){for(const e of this.disposables)e.dispose();this.disposables=[]}}class P extends L{add(e){return this.addDisposable(e)}}const N=BigInt(0),B=BigInt(1),T=BigInt(2),R=T**BigInt(64);function W(e,t=0,n=e.byteLength-t){const r=new DataView(e);let i=N;for(let e=t;e<t+n;e+=8){i*=R;i+=r.getBigUint64(e,!1)}return i}function z(e,t,n=0){const r=new DataView(e);for(;t>N;)r.setBigUint64(n,t,!0),n+=8,t/=R}function M(e){return[W(e,38,256),W(e,303,256)]}function F(e){const[t]=M(e),n=new ArrayBuffer(524),r=new DataView(n);r.setUint32(0,64,!0);const i=function(e,t){if([e,t]=[Number(e),Number(t)],Number.isNaN(e)||Number.isNaN(t))return NaN;if(!(e=(e%t+t)%t)||t<2)return NaN;const n=[];let r=t;for(;r;)[e,r]=[r,e%r],n.push({a:e,b:r});if(1!==e)return NaN;let i=1,a=0;for(let e=n.length-2;e>=0;--e)[i,a]=[a,i-a*Math.floor(n[e].a/n[e].b)];return(a%t+t)%t}(Number(BigInt.asUintN(32,t)*BigInt(-1)),2**32);return r.setUint32(4,i,!0),z(n,t,8),z(n,BigInt(2)**BigInt(4096)%t,264),r.setUint32(520,65537,!0),n}const K=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20];function V(e,t){const[n,r]=M(e),i=new Uint8Array(256);let a=0;i[a]=0,a+=1,i[a]=1,a+=1;const s=i.length-K.length-t.byteLength-1;for(;a<s;)i[a]=255,a++;i[a]=0,a+=1,i.set(new Uint8Array(K),a),a+=K.length,i.set(new Uint8Array(t),a);let o=function(e,t,n){if(n===B)return N;let r=B;for(e%=n;t>N;)BigInt.asUintN(1,t)===B&&(r=r*e%n),t>>=B,e=e**T%n;return r}(W(i.buffer),r,n);const c=new ArrayBuffer(256);return function(e,t,n=0){const r=[];for(;t>N;)r.push(BigInt.asUintN(64,t)),t/=R;const i=new DataView(e);for(let e=r.length-1;e>=0;e-=1)i.setBigUint64(n,r[e],!1),n+=8}(c,o),c}var Q,H;!function(e){e.command=function(e){const t=e.length;if(4!==t)throw new Error("AdbPacket: command.length mismatch. Expected 4, but got "+t)},e.magic=function(e){const t=4294967295^e.getUint32(0),n=e.getInt32(20);if(t!==n)throw new Error(`AdbPacket: magic number mismatch. Expected ${t}, but got ${n}`)}}(Q||(Q={})),function(e){e.Connect="CNXN",e.Auth="AUTH",e.OK="OKAY",e.Close="CLSE",e.Write="WRTE",e.Open="OPEN"}(H||(H={}));class ${constructor(e,t,n,r,i){this.backend=e,Q.command(t),this.command=t,this.arg0=n,this.arg1=r,"string"==typeof i?this.payloadString=i:this.payload=i}static parse(e){return Object(S.d)(this,void 0,void 0,(function*(){let t=yield e.read(24);24!==t.byteLength&&(t=yield e.read(24));const n=new DataView(t);Q.magic(n);const r=e.decodeUtf8(t.slice(0,4)),i=n.getUint32(4,!0),a=n.getUint32(8,!0),s=n.getUint32(12,!0);let o;return 0!==s&&(o=yield e.read(s)),new $(e,r,i,a,o)}))}static send(e,t,n,r,i){return new $(e,t,n,r,i).send()}get payloadLength(){return this._payloadLength}get payload(){return this._payload}set payload(e){void 0!==e?(this._payloadLength=e.byteLength,this._payload=e):(this._payloadLength=0,this._payload=void 0),this._payloadString=void 0}get payloadString(){if(this._payload)return this._payloadString||(this._payloadString=this.backend.decodeUtf8(this._payload)),this._payloadString}set payloadString(e){void 0!==e?(this.payload=this.backend.encodeUtf8(e),this._payloadString=e):this.payload=void 0}send(){return Object(S.d)(this,void 0,void 0,(function*(){const e=new ArrayBuffer(24);new Uint8Array(e).set(new Uint8Array(this.backend.encodeUtf8(this.command)));const t=new DataView(e);t.setUint32(4,this.arg0,!0),t.setUint32(8,this.arg1,!0),t.setUint32(12,this.payloadLength,!0),t.setUint32(16,0,!0),t.setUint32(20,4294967295^t.getUint32(0,!0),!0),yield this.backend.write(e),this.payload&&(yield this.backend.write(this.payload))}))}}class G{constructor(e=!1){this.list=[],this.blocking=e}wait(){if(!this.blocking&&(this.blocking=!0,0===this.list.length))return Promise.resolve();const e=new A.PromiseResolver;return this.list.push(e),e.promise}notify(){0!==this.list.length?this.list.pop().resolve():this.blocking=!1}dispose(){for(const e of this.list)e.reject(new Error("The AutoResetEvent has been disposed"));this.list.length=0}}let q=[],Y=[],Z=0;function J(e,t){const n=e.charCodeAt(0),r=t.charCodeAt(0),i=r-n+1;for(let e=n;e<=r;e++)Y.push(String.fromCharCode(e));q.push({start:n,length:i,end:r,offset:n-Z}),Z+=i}function X(e){const t=e.charCodeAt(0);let n=0,r=q.length-1,i=r>>1;for(;;){const e=q[i];if(t<e.start)r=i-1;else{if(!(t>e.end))return t-e.offset;n=i+1}i=n+r>>1}}function ee(e){const t=new Uint8Array(e),n=e.byteLength,r=n%3;let i="",a=0;for(;a<n-r;){const e=t[a];a+=1;const n=t[a];a+=1;const r=t[a];a+=1,i+=Y[e>>2],i+=Y[(3&e)<<4|n>>4],i+=Y[(15&n)<<2|r>>6],i+=Y[63&r]}if(1===r){const e=t[a];i+=Y[e>>2],i+=Y[(3&e)<<4],i+="=="}else if(2===r){const e=t[a];a+=1;const n=t[a];i+=Y[e>>2],i+=Y[(3&e)<<4|n>>4],i+=Y[(15&n)<<2],i+="="}return i}J("A","Z"),J("a","z"),J("0","9"),J("+","+"),J("/","/"),q=q.sort((e,t)=>e.end-t.end);class te{constructor(){this.pullQueue=[],this.pushQueue=[],this.ended=!1,this.pendingLowWaterEvent=!1,this.lowWaterEvent=new U}get onLowWater(){return this.lowWaterEvent.event}}class ne{constructor(e){this.maxConsumerCount=1/0,this.highWaterMark=10,this.lowWaterMark=0,this.state=e}get onLowWater(){return this.state.lowWaterEvent.event}push(e){return this.state.pullQueue.length?(this.state.pullQueue.shift().resolve({done:!1,value:e}),!0):(this.state.pushQueue.push(e),this.state.pushQueue.length<this.highWaterMark||(this.state.pendingLowWaterEvent=!0,!1))}end(){for(this.state.ended=!0;this.state.pullQueue.length;)this.state.pullQueue.shift().resolve({done:!0,value:void 0});this.state.cleanup(this.state.pushQueue)}}class re{constructor(e){this.initializer=e}[Symbol.asyncIterator](){const e=new te,t=new ne(e);return e.cleanup=this.initializer(t),{next(){if(e.pushQueue.length){const n=e.pushQueue.shift();return e.pendingLowWaterEvent&&e.pushQueue.length<=t.lowWaterMark&&e.lowWaterEvent.fire(),Promise.resolve({done:!1,value:n})}if(e.ended)return Promise.resolve({done:!0,value:void 0});if(e.pullQueue.length<t.maxConsumerCount){const t=new A.PromiseResolver;return e.pullQueue.push(t),t.promise}return Promise.reject(new Error("Max consumer count exceeded"))},return:()=>(t.end(),Promise.resolve({done:!0,value:void 0}))}}}var ie;!function(e){e[e.Token=1]="Token",e[e.Signature=2]="Signature",e[e.PublicKey=3]="PublicKey"}(ie||(ie={}));const ae=[class{constructor(e){this.iteratorDone=!1,this.backend=e,this.iterator=e.iterateKeys()}tryAuth(e){return Object(S.d)(this,void 0,void 0,(function*(){if(e.arg0!==ie.Token)return;const t=yield this.iterator.next();if(t.done)return void(this.iteratorDone=!0);const n=V(t.value,e.payload);return new $(this.backend,H.Auth,ie.Signature,0,n)}))}dispose(){var e,t;this.iteratorDone||null===(t=(e=this.iterator).return)||void 0===t||t.call(e)}},class{constructor(e){this.backend=e}tryAuth(){var e;return Object(S.d)(this,void 0,void 0,(function*(){let t;const n=this.backend.iterateKeys(),r=yield n.next();r.done?t=yield this.backend.generateKey():(t=r.value,yield null===(e=n.return)||void 0===e?void 0:e.call(n));const i=F(t);return new $(this.backend,H.Auth,ie.PublicKey,0,ee(i)+"\0")}))}dispose(){}}];class se extends L{constructor(e,t){super(),this.index=0,this.authenticators=e.map(e=>this.addDisposable(new e(t)))}tryNextAuth(e){return Object(S.d)(this,void 0,void 0,(function*(){for(;this.index<this.authenticators.length;){const t=yield this.authenticators[this.index].tryAuth(e);if(t)return t;this.index+=1}throw new Error("Cannot authenticate with device")}))}}class oe{constructor(e){this.mode="read",this.extraBuffers=[],this.stream=e}get backend(){return this.stream.backend}get localId(){return this.stream.localId}get remoteId(){return this.stream.remoteId}read(e){return Object(S.d)(this,void 0,void 0,(function*(){if("none"!==this.mode&&"read"!==this.mode)throw new Error(`This BufferedStream is in ${this.mode} mode`);let t,n;if(this.readIterator||(this.readIterator=this[Symbol.asyncIterator]()),this.mode="read",this.readBuffer){const r=this.readBuffer;if(r.byteLength>e)return this.readBuffer=r.slice(e),r.slice(0,e);t=new Uint8Array(e),t.set(new Uint8Array(r)),n=r.byteLength,this.readBuffer=void 0}else t=new Uint8Array(e),n=0;for(;n<e;){const r=yield this.readIterator.next();if(r.done)throw new Error("This BufferedStream has been closed");const i=r.value;if(i.byteLength>e-n)return t.set(new Uint8Array(i.slice(0,e)),n),this.readBuffer=i.slice(e),t.buffer;t.set(new Uint8Array(i),n),n+=i.byteLength}return t.buffer}))}readAll(){var e,t;return Object(S.d)(this,void 0,void 0,(function*(){let n="";try{for(var r,i=Object(S.b)(this);!(r=yield i.next()).done;){const e=r.value;n+=this.stream.backend.decodeUtf8(e)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&(yield t.call(i))}finally{if(e)throw e.error}}return n}))}write(e){return this.stream.write(e)}close(){return this.stream.close()}[Symbol.asyncIterator](){var e,t;return this.readIterator&&(null===(t=(e=this.readIterator).return)||void 0===t||t.call(e),this.readIterator=void 0),new re(e=>{e.maxConsumerCount=1;for(const t of this.extraBuffers)e.push(t);this.extraBuffers.length=0;const t=new P,n=new G(!0);return t.add(this.stream.onData(t=>{if(!e.push(t))return n.wait()})),t.add(this.stream.onClose(()=>{e.end()})),t.add(e.onLowWater(()=>{n.notify()})),this.mode="iterate",e=>{this.extraBuffers=e,this.mode="none",t.dispose()}})[Symbol.asyncIterator]()}}class ce extends L{constructor(e,t,n){super(),this.writeLock=this.addDisposable(new G),this.dataEvent=this.addDisposable(new I),this.closeEvent=this.addDisposable(new U),this.localId=e,this.remoteId=t,this.dispatcher=n}get backend(){return this.dispatcher.backend}get onClose(){return this.closeEvent.event}write(e){return Object(S.d)(this,void 0,void 0,(function*(){yield this.writeLock.wait(),yield this.dispatcher.sendPacket(H.Write,this.localId,this.remoteId,e)}))}ack(){this.writeLock.notify()}close(){return this.dispatcher.sendPacket(H.Close,this.localId,this.remoteId)}dispose(){this.closeEvent.fire(),super.dispose()}}class le extends L{constructor(e){super(),this.initializers=new x.a(1),this.streams=new Map,this.onPacketEvent=this.addDisposable(new U),this.onPacket=this.onPacketEvent.event,this.onReceiveErrorEvent=this.addDisposable(new U),this.onReceiveError=this.onReceiveErrorEvent.event,this._running=!0,this.backend=e,this.receiveLoop()}get running(){return this._running}createStream(e){return Object(S.d)(this,void 0,void 0,(function*(){const[t,n]=this.initializers.add();yield this.sendPacket(H.Open,t,0,e);const r=yield n,i=new ce(t,r,this);return this.streams.set(i.localId,i),new de(i)}))}sendPacket(e,t,n,r){return 1===arguments.length?e.send():$.send(this.backend,e,t,n,r)}dispose(){this._running=!1;for(const e of this.streams.values())e.dispose();this.streams.clear(),super.dispose()}receiveLoop(){return Object(S.d)(this,void 0,void 0,(function*(){for(;this._running;)try{const e=yield $.parse(this.backend);let t=!1;switch(e.command){case H.OK:t=!0,this.initializers.resolve(e.arg1,e.arg0)||(this.streams.has(e.arg1)?this.streams.get(e.arg1).ack():this.sendPacket(H.Close,e.arg1,e.arg0));break;case H.Close:if(0===e.arg0)this.initializers.reject(e.arg1,new Error("open failed"))&&(t=!0);else if(this.streams.has(e.arg1)){this.streams.get(e.arg1).dispose(),this.streams.delete(e.arg1),t=!0}break;case H.Write:this.streams.has(e.arg1)&&(yield this.sendPacket(H.OK,e.arg1,e.arg0),yield this.streams.get(e.arg1).dataEvent.fire(e.payload),t=!0)}if(!t){const t={handled:!1,packet:e};if(this.onPacketEvent.fire(t),!t.handled)return void this.dispose()}}catch(e){this._running,this.onReceiveErrorEvent.fire(e)}}))}}class de{constructor(e){this.controller=e}get backend(){return this.controller.backend}get localId(){return this.controller.localId}get remoteId(){return this.controller.remoteId}get onData(){return this.controller.dataEvent.event}get onClose(){return this.controller.onClose}write(e){return this.controller.write(e)}close(){return this.controller.close()}}var ue,he,fe,me;!function(e){e.List="LIST",e.Send="SEND",e.Stat="STAT",e.Data="DATA",e.Done="DONE",e.Receive="RECV"}(ue||(ue={})),function(e){e.Entry="DENT",e.Done="DONE",e.Data="DATA",e.Ok="OKAY"}(he||(he={}));class pe{constructor(e){this.id=e}}class ve extends pe{constructor(e,t){super(e),this.value=t}toBuffer(e){const t=e.encodeUtf8(this.value),n=new Uint8Array(8+t.byteLength),r=e.encodeUtf8(this.id);n.set(new Uint8Array(r));return new DataView(n.buffer).setUint32(4,t.byteLength,!0),n.set(new Uint8Array(t),8),n.buffer}}!function(e){e[e.Directory=4]="Directory",e[e.File=8]="File",e[e.Link=10]="Link"}(fe||(fe={}));class be{constructor(e,t,n,r){this.id=he.Entry,this.type=e>>12,this.mode=4095&e,this.size=t,this.lastModifiedTime=n,this.name=r}static parse(e){return Object(S.d)(this,void 0,void 0,(function*(){const t=yield e.read(16),n=new DataView(t),r=n.getUint32(0,!0),i=n.getUint32(4,!0),a=n.getUint32(8,!0),s=n.getUint32(12,!0),o=e.backend.decodeUtf8(yield e.read(s));return new be(r,i,a,o)}))}}class ye{constructor(e){this.id=he.Data,this.data=e}static parse(e){return Object(S.d)(this,void 0,void 0,(function*(){const t=yield e.read(4),n=new DataView(t).getUint32(0,!0),r=yield e.read(n);return new ye(r)}))}}class ge{constructor(){this.id=he.Done}}function we(e){return Object(S.d)(this,void 0,void 0,(function*(){switch(e.backend.decodeUtf8(yield e.read(4))){case he.Entry:return yield be.parse(e);case he.Data:return yield ye.parse(e);case he.Done:return yield e.read(4),new ge;default:throw new Error("")}}))}class Ee extends L{constructor(e){super(),this.sendLock=this.addDisposable(new G),this.stream=new oe(e)}list(e){return Object(S.d)(this,void 0,void 0,(function*(){yield this.sendLock.wait();try{yield this.write(new ve(ue.List,e));const t=[];for(;;){const e=yield we(this.stream);switch(e.id){case he.Entry:t.push(e);break;case he.Done:return t;default:throw new Error("Unexpected response id")}}}finally{this.sendLock.notify()}}))}receive(e){return Object(S.a)(this,arguments,(function*(){yield Object(S.c)(this.sendLock.wait());try{for(yield Object(S.c)(this.write(new ve(ue.Receive,e)));;){const e=yield Object(S.c)(we(this.stream));switch(e.id){case he.Data:yield yield Object(S.c)(e.data);break;case he.Done:return yield Object(S.c)(void 0);default:throw new Error("Unexpected response id")}}}finally{this.sendLock.notify()}}))}dispose(){super.dispose(),this.stream.close()}write(e){return this.stream.write(e.toBuffer(this.stream.backend))}}!function(e){e.Product="ro.product.name",e.Model="ro.product.model",e.Device="ro.product.device",e.Features="features"}(me||(me={}));class ke{constructor(e){this._connected=!1,this.backend=e,this.packetDispatcher=new le(e),e.onDisconnected(this.dispose,this)}get onDisconnected(){return this.backend.onDisconnected}get connected(){return this._connected}get name(){return this.backend.name}get product(){return this._product}get model(){return this._model}get device(){return this._device}get features(){return this._features}connect(e=ae){return Object(S.d)(this,void 0,void 0,(function*(){const t=["shell_v2","cmd","stat_v2","ls_v2","fixed_push_mkdir","apex","abb","fixed_push_symlink_timestamp","abb_exec","remount_shell","track_app","sendrecv_v2","sendrecv_v2_brotli","sendrecv_v2_lz4","sendrecv_v2_zstd","sendrecv_v2_dry_run_send"].join(","),n=new A.PromiseResolver,r=new se(e,this.backend),i=new P;i.add(this.packetDispatcher.onPacket(e=>Object(S.d)(this,void 0,void 0,(function*(){e.handled=!0;const{packet:t}=e;try{switch(t.command){case H.Connect:if(16777217!==t.arg0)throw new Error("Version mismatch");this.parseBanner(t.payloadString),n.resolve();break;case H.Auth:const i=yield r.tryNextAuth(e.packet);yield this.packetDispatcher.sendPacket(i);break;case H.Close:break;default:throw new Error("Device not in correct state. Reconnect your device and try again")}}catch(e){n.reject(e)}})))),i.add(this.packetDispatcher.onReceiveError(e=>{n.reject(e)})),yield this.packetDispatcher.sendPacket(H.Connect,16777217,1048576,"host::features="+t);try{yield n.promise,this._connected=!0}finally{i.dispose()}}))}parseBanner(e){const t=e.split("::");if(t.length>1){const e=t[1];for(const t of e.split(";")){if(!t)continue;const e=t.split("=");if(2!==e.length)continue;const[n,r]=e;switch(n){case me.Product:this._product=r;break;case me.Model:this._model=r;break;case me.Device:this._device=r;break;case me.Features:this._features=r.split(",")}}}}shell(e,...t){return e?this.createStreamAndReadAll(`shell:${e} ${t.join(" ")}`):this.createStream("shell:")}getDaemonTcpAddresses(){return Object(S.d)(this,void 0,void 0,(function*(){const e=(yield this.shell("getprop","service.adb.listen_addrs")).trim();if(e)return e.split(",");let t=(yield this.shell("getprop","service.adb.tcp.port")).trim();return t?["0.0.0.0:"+t]:(t=(yield this.shell("getprop","persist.adb.tcp.port")).trim(),t?["0.0.0.0:"+t]:[])}))}setDaemonTcpPort(e=5555){return this.createStreamAndReadAll("tcpip:"+e)}disableDaemonTcp(){return this.createStreamAndReadAll("usb:")}sync(){return Object(S.d)(this,void 0,void 0,(function*(){const e=yield this.createStream("sync:\0");return new Ee(e)}))}createStream(e){return Object(S.d)(this,void 0,void 0,(function*(){return this.packetDispatcher.createStream(e)}))}createStreamAndReadAll(e){return Object(S.d)(this,void 0,void 0,(function*(){const t=yield this.createStream(e);return new oe(t).readAll()}))}dispose(){return Object(S.d)(this,void 0,void 0,(function*(){this.packetDispatcher.dispose(),yield this.backend.dispose()}))}}var Oe=n("mLw9");const je={classCode:255,subclassCode:66,protocolCode:1},De=new TextEncoder,Ce=new TextDecoder;class Se{constructor(e,t,n){this.onDisconnectedEvent=new U,this.onDisconnected=this.onDisconnectedEvent.event,this._device=e,this._inEndpointNumber=t,this._outEndpointNumber=n}static fromDevice(e){var t;return Object(Oe.a)(this,void 0,void 0,(function*(){yield e.open();for(const n of e.configurations)for(const r of n.interfaces)for(const i of r.alternates)if(i.interfaceSubclass===je.subclassCode&&i.interfaceClass===je.classCode&&i.interfaceSubclass===je.subclassCode){let a,s;(null===(t=e.configuration)||void 0===t?void 0:t.configurationValue)!==n.configurationValue&&(yield e.selectConfiguration(n.configurationValue)),r.claimed||(yield e.claimInterface(r.interfaceNumber)),r.alternate.alternateSetting!==i.alternateSetting&&(yield e.selectAlternateInterface(r.interfaceNumber,i.alternateSetting));for(const t of i.endpoints)switch(t.direction){case"in":if(a=t.endpointNumber,void 0!==s)return new Se(e,a,s);break;case"out":if(s=t.endpointNumber,void 0!==a)return new Se(e,a,s)}}throw new Error("Unknown error")}))}static pickDevice(){return Object(Oe.a)(this,void 0,void 0,(function*(){try{const e=yield navigator.usb.requestDevice({filters:[je]});return Se.fromDevice(e)}catch(e){switch(e.name){case"NotFoundError":return;default:throw e}}}))}get name(){return this._device.productName}*iterateKeys(){const e=window.localStorage.getItem("private-key");e&&(yield function(e){let t;t="="===e[e.length-2]?2:"="===e[e.length-1]?1:0;const n=new Uint8Array(e.length/4*3-t);let r=0,i=0;for(;r<e.length-(0!==t?4:0);){const t=X(e[r]);r+=1;const a=X(e[r]);r+=1;const s=X(e[r]);r+=1;const o=X(e[r]);r+=1,n[i]=t<<2|(48&a)>>4,i+=1,n[i]=(15&a)<<4|(60&s)>>2,i+=1,n[i]=(3&s)<<6|o,i+=1}if(1===t){const t=X(e[r]);r+=1;const a=X(e[r]);r+=1;const s=X(e[r]);n[i]=t<<2|(48&a)>>4,i+=1,n[i]=(15&a)<<4|(60&s)>>2}else if(2===t){const t=X(e[r]);r+=1;const a=X(e[r]);n[i]=t<<2|(48&a)>>4}return n.buffer}(e))}generateKey(){return Object(Oe.a)(this,void 0,void 0,(function*(){const{privateKey:e}=yield crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-1"},!0,["sign","verify"]),t=yield crypto.subtle.exportKey("pkcs8",e);return window.localStorage.setItem("private-key",ee(t)),t}))}encodeUtf8(e){return De.encode(e)}decodeUtf8(e){return Ce.decode(e)}write(e){return Object(Oe.a)(this,void 0,void 0,(function*(){yield this._device.transferOut(this._outEndpointNumber,e)}))}read(e){return Object(Oe.a)(this,void 0,void 0,(function*(){try{const t=yield this._device.transferIn(this._inEndpointNumber,e);return"stall"===t.status&&(yield this._device.clearHalt("in",this._inEndpointNumber)),t.data.buffer}catch(e){throw e instanceof Error&&"NotFoundError"===e.name&&this.onDisconnectedEvent.fire(),e}}))}dispose(){return Object(Oe.a)(this,void 0,void 0,(function*(){this.onDisconnectedEvent.dispose(),yield this._device.close()}))}}function Ae(e,t){return t.displayName=e,Object(p.memo)(t)}var xe=Ae("Connect",({device:e,onDeviceChange:t})=>{const[n,a]=Object(p.useState)(!1),[s,{setTrue:o,setFalse:c}]=Object(C.a)(!1),[l,u]=Object(p.useState)(),h=Object(p.useCallback)(async()=>{try{const e=await Se.pickDevice();if(e){const n=new ke(e);try{a(!0),await n.connect(),t(n)}catch(e){throw n.dispose(),e}}}catch(e){u(e.message),o()}finally{a(!1)}},[t]),f=Object(p.useCallback)(async()=>{try{await e.dispose(),t(void 0)}catch(e){u(e.message),o()}},[e]);return Object(p.useEffect)(()=>null==e?void 0:e.onDisconnected(()=>{t(void 0)}),[e,t]),v.a.createElement(v.a.Fragment,null,v.a.createElement(r.a,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8,padding:8}},!e&&v.a.createElement(i.a,null,v.a.createElement(d.a,{text:"Connect",onClick:h})),e&&v.a.createElement(i.a,null,v.a.createElement(E.a,{text:"Disconnect",onClick:f})),v.a.createElement(i.a,null,e&&"Connected to "+e.name)),v.a.createElement(k.a,{hidden:!n,dialogContentProps:{title:"Connecting",subText:"Please authorize the connection on your device"}},v.a.createElement(O.a,null)),v.a.createElement(k.a,{hidden:!s,dialogContentProps:{type:j.a.normal,title:"Error",subText:l}},v.a.createElement(D.a,null,v.a.createElement(d.a,{text:"OK",onClick:c}))))}),_e=n("tqYG"),Ue=n("DeEv"),Ie=n("JwHi"),Le=n("zv84"),Pe=n("t/Ec"),Ne=n("XIMn"),Be=n("TkDl"),Te=n("9z8q"),Re=n("aupw"),We=n("KWRb"),ze=n("X0IQ"),Me=n("8weS"),Fe=n("v8ot"),Ke=n("Nxe8"),Ve=n.n(Ke);Object(We.a)(),Ve.a.mitm="streamsaver/mitm.html";const Qe=[" B"," KB"," MB"," GB"];function He(e){const t=e.lastIndexOf(".");return-1===t?"":e.slice(t)}const $e=(e,t)=>e&&t?t({...e,styles:Object(_e.l)(e.styles,{root:{paddingTop:0}})}):null;function Ge(...e){return e.reduce((e,t)=>e.endsWith("/")?`${e}${t}`:`${e}/${t}`,"")}function qe(e){return new ReadableStream({async pull(t){const{desiredSize:n}=t;if(!n||n<0)return;let r=0;for(;r<n;){const n=await e.next();if(n.done)return void t.close();t.enqueue(new Uint8Array(n.value)),r+=n.value.byteLength}}})}var Ye=Ae("FileManager",({device:e})=>{const[t,n]=Object(p.useState)("/"),[r,a]=Object(p.useState)(!1),s=Object(p.useRef)();Object(p.useLayoutEffect)(()=>{s.current&&(s.current.parentElement.scrollTop=0)},[r]);const o=Object(p.useMemo)(()=>({ref:s}),[]),[l,d]=Object(p.useState)([]);Object(p.useEffect)(()=>{(async()=>{if(d([]),!e)return void n("/");a(!0);const r=await e.sync();try{let e=await r.list(t);e=e.filter(e=>"."!==e.name&&".."!==e.name),e.sort((e,t)=>e.type===fe.Directory?t.type===fe.Directory?e.name<t.name?-1:1:-1:t.type===fe.Directory?1:e.name<t.name?-1:1),d(e)}finally{a(!1),r.dispose()}})()},[e,t]);const[u,h]=Object(p.useState)(),f=Object(p.useCallback)(async t=>{const n=await e.sync();try{const e=qe(n.receive(t)),r=new Response(e),i=await r.blob(),a=window.URL.createObjectURL(i);h(a)}finally{n.dispose()}},[e]),m=Object(p.useCallback)(()=>{h(void 0)},[]),b=Object(p.useCallback)(e=>{switch(e.type){case fe.Link:case fe.Directory:n(Ge(t,e.name));break;case fe.File:switch(He(e.name)){case".jpg":case".png":case".svg":case".gif":f(Ge(t,e.name))}}},[t,f]),y=Object(p.useMemo)(()=>[{key:"type",name:"File Type",iconName:"Page",isIconOnly:!0,minWidth:20,maxWidth:20,isCollapsible:!0,onRender(e){switch(e.type){case fe.Link:return v.a.createElement(Ue.a,Object.assign({},Object(ze.a)({size:20,type:Me.a.linkedFolder})));case fe.Directory:return v.a.createElement(Ue.a,Object.assign({},Object(ze.a)({size:20,type:Me.a.folder})));case fe.File:return v.a.createElement(Ue.a,Object.assign({},Object(ze.a)({size:20,extension:He(e.name)})));default:return v.a.createElement(Ue.a,Object.assign({},Object(ze.a)({size:20,extension:"txt"})))}}},{key:"name",name:"Name",fieldName:"name",minWidth:0,isRowHeader:!0,isSorted:!0,onRender:e=>v.a.createElement(c.a,{onClick:()=>b(e),styles:{root:{color:"inherit","&:active, &:hover, &:active:hover, &:focus":{color:"inherit"}}}},e.name)},{key:"mode",name:"Mode",fieldName:"mode",minWidth:0,onRender:e=>`0${(e.mode>>6&4).toString(8)}${(e.mode>>3&4).toString(8)}${(4&e.mode).toString(8)}`},{key:"size",name:"Size",fieldName:"size",minWidth:0,onRender:e=>e.type===fe.File?function(e){let t=0;for(;t<Qe.length&&e>1024;)t+=1,e/=1024;return e.toLocaleString(void 0,{maximumFractionDigits:2})+Qe[t]}(e.size):""},{key:"lastModifiedTime",name:"Last Modified Time",fieldName:"lastModifiedTime",minWidth:150,onRender:e=>new Date(1e3*e.lastModifiedTime).toLocaleString()}],[b]),g=Object(p.useCallback)((e,t)=>{var n,r;return null!==(r=null!==(n=null==e?void 0:e.name)&&void 0!==n?n:null==t?void 0:t.toString())&&void 0!==r?r:""},[]),w=Object(p.useMemo)(()=>{let e="";const r=t.split("/").filter(Boolean).map(t=>(e+="/"+t,{key:e,text:t,onClick:(e,t)=>{t&&n(t.key)}}));return r.unshift({key:"/",text:"/",onClick:()=>n("/")}),r[r.length-1].isCurrentItem=!0,r[r.length-1].onClick=void 0,r},[t]),[E,k]=Object(p.useState)([]),[O,j]=Object(p.useState)(),D=Object(p.useCallback)((n,r,i)=>{if(!n)return!1;let a=[];return n.type===fe.File&&a.push({key:"download",text:"Download",onClick:()=>((async()=>{const r=await e.sync();try{const e=Ge(t,n.name),i=qe(r.receive(e)),a=Ve.a.createWriteStream(n.name,{size:n.size});await i.pipeTo(a)}finally{r.dispose()}})(),!1)}),!!a.length&&(k(a),j(i),!1)},[t,e]),C=Object(Fe.a)(()=>{j(void 0)});return v.a.createElement(v.a.Fragment,null,e&&v.a.createElement(i.a,null,v.a.createElement(Ie.a,{items:w})),v.a.createElement(i.a,{root:o,grow:!0,styles:{root:{minHeight:0}}},v.a.createElement(Le.a,{items:l,columns:y,getKey:g,setKey:t,layoutMode:Pe.e.justified,enableShimmer:r,onItemInvoked:b,onItemContextMenu:D,onRenderDetailsHeader:$e,usePageCache:!0})),u&&v.a.createElement(Ne.a,null,v.a.createElement(Be.a,{onClick:m},v.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},v.a.createElement("img",{src:u,style:{maxWidth:"100%",maxHeight:"100%"}})))),v.a.createElement(Te.a,{items:E,hidden:!O,directionalHint:Re.a.bottomLeftEdge,target:O,onDismiss:C}))});n("p2bk");const Ze={tokens:{childrenGap:8,padding:8},verticalFill:!0,className:_e.a.slideUpIn10,styles:{root:{overflow:"auto"}}},Je=Ae("CacheRoute",e=>{const t=Object(g.f)(e),n=Object(p.useRef)(!!t);!n.current&&t&&(n.current=!0);const i=Object(p.useMemo)(()=>({...Ze,styles:Object(_e.l)(Ze.styles,{root:{display:t?"flex":"none"}})}),[!!t]);return n.current?v.a.createElement(r.a,Object.assign({},i),e.children):null}),Xe=Ae("CacheSwitch",e=>{const t=Object(g.e)();let n,r,i=Object(g.f)(),a=[];return v.a.Children.forEach(e.children,e=>{var s;if(v.a.isValidElement(e)){const o=e.type===Je;if(o&&a.push(e),r)return;const c=null!==(s=e.props.path)&&void 0!==s?s:e.props.from,l=c?Object(g.d)(t.pathname,{...e.props,path:c}):i;l&&(r=l,n=o?void 0:e)}}),v.a.createElement(v.a.Fragment,null,a,n?v.a.cloneElement(n,{location:t,computedMatch:r}):null)});var et=n("WDP9"),tt=n("2WvF"),nt=n("/POA"),rt=n("R9As"),it=n("0fl0");n("q7KB");const at={position:"absolute",top:0,left:0,width:"100%",height:"100%",visibility:"hidden"};var st=Ae("ResizeObserver",({onResize:e,style:t,children:n,...r})=>{const i=Object(p.useRef)(e);i.current=e;const a=Object(p.useCallback)(()=>{i.current()},[]),s=Object(p.useCallback)(e=>{e&&e.contentWindow.addEventListener("resize",a)},[]),o=v.a.useMemo(()=>t?t.position?t:{...t,position:"relative"}:{position:"relative"},[t]);return v.a.createElement("div",Object.assign({style:o},r),v.a.createElement("iframe",{ref:s,style:at}),n)});const ot={width:"100%",height:"100%"};var ct=Ae("Shell",({device:e})=>{const[t,n]=Object(p.useState)(""),a=Object(p.useRef)(),s=Object(p.useCallback)((e,t)=>{n(null!=t?t:""),t&&a.current.findNext(t,{incremental:!0})},[]),o=Object(p.useCallback)(()=>{a.current.findPrevious(t)},[t]),c=Object(p.useCallback)(()=>{a.current.findNext(t)},[t]),[l,d]=Object(p.useState)(),u=Object(p.useRef)(),h=Object(p.useCallback)(e=>{if(!e)return;const t=new nt.Terminal({scrollback:9001}),n=new it.SearchAddon;a.current=n,t.loadAddon(n);const r=new rt.FitAddon;u.current=r,t.loadAddon(r),d(t),t.open(e),r.fit()},[]);Object(p.useEffect)(()=>()=>null==l?void 0:l.dispose(),[]),Object(p.useEffect)(()=>{if(e&&l)return(async()=>{const t=await e.shell(),n=new TextEncoder;l.onData(e=>{const{buffer:r}=n.encode(e);t.write(r)}),t.onData(e=>{l.write(new Uint8Array(e))})})(),()=>{l.reset(),l.clear()}},[e,l]);const f=Object(p.useCallback)(()=>{var e;null===(e=u.current)||void 0===e||e.fit()},[]);return v.a.createElement(v.a.Fragment,null,v.a.createElement(i.a,null,v.a.createElement(r.a,{horizontal:!0},v.a.createElement(i.a,{grow:!0},v.a.createElement(et.a,{placeholder:"Find",value:t,onChange:s,onSearch:c})),v.a.createElement(i.a,null,v.a.createElement(tt.a,{disabled:!t,iconProps:{iconName:"ChevronUp"},onClick:o})),v.a.createElement(i.a,null,v.a.createElement(tt.a,{disabled:!t,iconProps:{iconName:"ChevronDown"},onClick:c})))),v.a.createElement(i.a,{grow:!0,styles:{root:{minHeight:0}}},v.a.createElement(st,{style:ot,onResize:f},v.a.createElement("div",{ref:h,style:{height:"100%"}}))))});Object(f.a)(),y.a.render(v.a.createElement(w.a,null,v.a.createElement((function(){var e;const t=Object(g.e)(),[n,f]=Object(p.useState)(),[b,y]=Object(p.useState)();Object(p.useEffect)(()=>{n||y(void 0)},[n]);const w=Object(p.useCallback)(async()=>{if(!n)return;const e=await n.getDaemonTcpAddresses();y(e)},[n]),[E,k]=Object(p.useState)("5555"),O=Object(m.a)("tcpPort"),j=Object(p.useCallback)(async()=>{if(!n)return;const e=await n.setDaemonTcpPort(Number.parseInt(E,10));console.log(e)},[n,E]),D=Object(p.useCallback)(async()=>{if(!n)return;const e=await n.disableDaemonTcp();console.log(e)},[n]);return v.a.createElement(r.a,{verticalFill:!0},v.a.createElement(i.a,{tokens:{padding:8}},v.a.createElement(a.a,{variant:"xxLarge"},"WebADB Demo")),v.a.createElement(i.a,null,v.a.createElement(xe,{device:n,onDeviceChange:f})),v.a.createElement(i.a,null,v.a.createElement(s.a,null)),v.a.createElement(i.a,{grow:!0,styles:{root:{minHeight:0}}},v.a.createElement(r.a,{horizontal:!0,verticalFill:!0,tokens:{childrenGap:8}},v.a.createElement(i.a,null,v.a.createElement(o.a,{styles:{root:{width:250}},groups:[{links:[{key:"/",name:"Introduction",url:"#/"},{key:"/device-info",name:"Device Info",url:"#/device-info"},{key:"/adb-over-wifi",name:"ADB over WiFi",url:"#/adb-over-wifi"},{key:"/shell",name:"Interactive Shell",url:"#/shell"},{key:"/file-manager",name:"File Manager",url:"#/file-manager"}]}],selectedKey:t.pathname})),v.a.createElement(i.a,{grow:!0,styles:{root:{minHeight:0,overflow:"hidden"}}},v.a.createElement(Xe,null,v.a.createElement(Je,{exact:!0,path:"/"},v.a.createElement(a.a,{block:!0},"This demo can connect to your Android devices using the"," ",v.a.createElement(c.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/USB",target:"_blank"},"WebUSB")," ","API."),v.a.createElement(a.a,{block:!0},"Before start, please make sure your adb server is not running (`adb kill-server`), as there can be only one connection to your device at same time.")),v.a.createElement(Je,{path:"/device-info"},v.a.createElement(i.a,null,"Product: ",null==n?void 0:n.product),v.a.createElement(i.a,null,"Model: ",null==n?void 0:n.model),v.a.createElement(i.a,null,"Device: ",null==n?void 0:n.device),v.a.createElement(i.a,null,"Features: ",null===(e=null==n?void 0:n.features)||void 0===e?void 0:e.join(","))),v.a.createElement(Je,{path:"/adb-over-wifi"},v.a.createElement(i.a,null,v.a.createElement(l.a,null,v.a.createElement(a.a,null,"Although WebADB can enable ADB over WiFi for you, it can't connect to your device wirelessly."))),v.a.createElement(i.a,null,v.a.createElement(l.a,null,v.a.createElement(a.a,null,"Your device will disconnect after changing ADB over WiFi config."))),v.a.createElement(r.a,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8}},v.a.createElement(i.a,null,v.a.createElement(d.a,{text:"Update Status",disabled:!n,onClick:w})),v.a.createElement(i.a,null,void 0!==b&&(0!==b.length?"Enabled at "+b.join(", "):"Disabled"))),v.a.createElement(r.a,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8}},v.a.createElement(i.a,null,v.a.createElement(u.a,{htmlFor:O},"Port: ")),v.a.createElement(i.a,null,v.a.createElement(h.a,{id:O,width:300,disabled:!n,value:E,onChange:(e,t)=>k(t)})),v.a.createElement(i.a,null,v.a.createElement(d.a,{text:"Enable",disabled:!n,onClick:j}))),v.a.createElement(i.a,null,v.a.createElement(d.a,{text:"Disable",disabled:!n||void 0===b||0===b.length,onClick:D}))),v.a.createElement(Je,{path:"/shell"},v.a.createElement(ct,{device:n})),v.a.createElement(Je,{path:"/file-manager"},v.a.createElement(Ye,{device:n})),v.a.createElement(g.a,{to:"/"}))))))}),null)),document.getElementById("container"))},p2bk:function(e,t,n){}});
//# sourceMappingURL=index.a5d566d7beaee13069ef.js.map