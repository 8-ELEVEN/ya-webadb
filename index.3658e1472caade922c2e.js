!function(e){function t(t){for(var a,s,o=t[0],c=t[1],l=t[2],u=0,h=[];u<o.length;u++)s=o[u],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&h.push(r[s][0]),r[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(d&&d(t);h.length;)h.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={0:0},i=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=c;i.push(["2YZa",1]),n()}({"2YZa":function(e,t,n){"use strict";n.r(t);var a=n("D2wA"),r=n("bBLm"),i=n("LDcz"),s=n("gTkT"),o=n("q1tI"),c=n.n(o),l=n("i8i4"),d=n.n(l),u=n("Ty5D"),h=n("55Ip"),f=n("uNUV"),p=n("uqg9"),m=n("wcX2"),b=n("sByA"),w=n("Ypxj"),g=n("ypaI"),y=n("+glh"),v=n.n(y);class E{constructor(){this.listeners=[],this.event=this.event.bind(this)}event(e,t,...n){const a={listener:e,thisArg:t,args:n};this.listeners.push(a);const r=()=>{const e=this.listeners.indexOf(a);e>0&&this.listeners.splice(e,1)};return r.dispose=r,r}fire(e){for(const t of this.listeners.slice())t.listener.apply(t.thisArg,[e,...t.args])}dispose(){this.listeners.length=0}}class k extends E{async fire(e){for(const t of this.listeners)await t.listener.apply(t.thisArg,[e,...t.args])}}class O{constructor(){this.disposables=[]}addDisposable(e){return this.disposables.push(e),e}dispose(){for(const e of this.disposables)e.dispose();this.disposables=[]}}class j extends O{add(e){return this.addDisposable(e)}}const S=BigInt(0),C=BigInt(1),x=BigInt(2),D=x**BigInt(64);function L(e,t=0,n=e.byteLength-t){const a=new DataView(e);let r=S;for(let e=t;e<t+n;e+=8){r*=D;r+=a.getBigUint64(e,!1)}return r}function A(e,t,n=0){const a=new DataView(e);for(;t>S;)a.setBigUint64(n,t,!0),n+=8,t/=D}function P(e){return[L(e,38,256),L(e,303,256)]}function _(e,t,n=0){const[a]=P(e);let r;if(t){if(t.byteLength-n<524)throw new Error("output buffer is too small");r="number"}else t=new ArrayBuffer(524),r="ArrayBuffer";const i=new DataView(t);i.setUint32(n,64,!0),n+=4;const s=function(e,t){if([e,t]=[Number(e),Number(t)],Number.isNaN(e)||Number.isNaN(t))return NaN;if(!(e=(e%t+t)%t)||t<2)return NaN;const n=[];let a=t;for(;a;)[e,a]=[a,e%a],n.push({a:e,b:a});if(1!==e)return NaN;let r=1,i=0;for(let e=n.length-2;e>=0;--e)[r,i]=[i,r-i*Math.floor(n[e].a/n[e].b)];return(i%t+t)%t}(Number(BigInt.asUintN(32,a)*BigInt(-1)),2**32);return i.setUint32(n,s,!0),A(t,a,n+=4),n+=256,A(t,BigInt(2)**BigInt(4096)%a,n),n+=256,i.setUint32(n,65537,!0),n+=4,"ArrayBuffer"===r?t:524}const z=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20];function I(e,t){const[n,a]=P(e),r=new Uint8Array(256);let i=0;r[i]=0,i+=1,r[i]=1,i+=1;const s=r.length-z.length-t.byteLength-1;for(;i<s;)r[i]=255,i+=1;r[i]=0,i+=1,r.set(new Uint8Array(z),i),i+=z.length,r.set(new Uint8Array(t),i);let o=function(e,t,n){if(n===C)return S;let a=C;for(e%=n;t>S;)BigInt.asUintN(1,t)===C&&(a=a*e%n),t>>=C,e=e**x%n;return a}(L(r.buffer),a,n);const c=new ArrayBuffer(256);return function(e,t,n=0){const a=[];for(;t>S;)a.push(BigInt.asUintN(64,t)),t/=D;const r=new DataView(e);for(let e=a.length-1;e>=0;e-=1)r.setBigUint64(n,a[e],!1),n+=8}(c,o),c}const U=Symbol("BackingField");function T(e,t){return e[U][t]}function N(e,t,n){e[U][t]=n}var F;(F||(F={})).initialize=function(e,t,n){switch(t.subType){case 0:Object.defineProperty(e,t.name,{configurable:!0,enumerable:!0,get:()=>T(e,t.name).buffer,set(n){N(e,t.name,{buffer:n})}});break;case 1:Object.defineProperty(e,t.name,{configurable:!0,enumerable:!0,get:()=>T(e,t.name).string,set(n){N(e,t.name,{string:n})}});break;default:throw new Error("Unknown type")}N(e,t.name,n)};const B={};function R(e){return B[e]}function M(e,t,n){B[n.type]=n}var W,K;M(0,0,{type:1,async deserialize({context:e,field:t}){const n=await e.read(t.options.length);switch(t.subType){case 0:return{value:n};case 1:return{value:e.decodeUtf8(n),extra:n};default:throw new Error("Unknown type")}},getSize:({field:e})=>e.options.length,initialize({extra:e,field:t,object:n,value:a}){const r={};"string"==typeof a?(r.string=a,e&&(r.buffer=e)):r.buffer=a,F.initialize(n,t,r)},serialize({context:e,dataView:t,field:n,object:a,offset:r}){var i;const s=T(a,n.name);null!==(i=s.buffer)&&void 0!==i||(s.buffer=e.encodeUtf8(s.string)),new Uint8Array(t.buffer).set(new Uint8Array(s.buffer),r)}}),function(e){e.SizeMap={0:1,1:2,2:4,3:4,4:8,5:8},e.DataViewGetterMap={0:"getUint8",1:"getUint16",2:"getInt32",3:"getUint32",4:"getBigUint64",5:"getBigInt64"},e.DataViewSetterMap={0:"setUint8",1:"setUint16",2:"setInt32",3:"setUint32",4:"setBigUint64",5:"setBigInt64"}}(W||(W={})),M(0,0,{type:0,getSize:({field:e})=>W.SizeMap[e.subType],async deserialize({context:e,field:t,options:n}){const a=await e.read(W.SizeMap[t.subType]);return{value:new DataView(a)[W.DataViewGetterMap[t.subType]](0,n.littleEndian)}},serialize({dataView:e,field:t,object:n,offset:a,options:r}){e[W.DataViewSetterMap[t.subType]](a,n[t.name],r.littleEndian)}}),function(e){function t(e,t){return T(e,t.options.lengthField)}function n(e,t,n){N(e,t.options.lengthField,n)}e.getLengthBackingField=t,e.setLengthBackingField=n,e.initialize=function(e,a,r,i){F.initialize(e,a,r);const s=Object.getOwnPropertyDescriptor(e,a.name);switch(delete e[a.name],a.subType){case 0:Object.defineProperty(e,a.name,{...s,set(t){var r;s.set.call(e,t),n(e,a,null!==(r=null==t?void 0:t.byteLength)&&void 0!==r?r:0)}}),delete e[a.options.lengthField],Object.defineProperty(e,a.options.lengthField,{configurable:!0,enumerable:!0,get:()=>t(e,a)});break;case 1:Object.defineProperty(e,a.name,{...s,set(t){s.set.call(e,t),n(e,a,t?void 0:0)}}),delete e[a.options.lengthField],Object.defineProperty(e,a.options.lengthField,{configurable:!0,enumerable:!0,get(){let r=t(e,a);if(void 0===r){const t=T(e,a.name),s=i.encodeUtf8(t.string);t.buffer=s,r=s.byteLength,n(e,a,r)}return r}});break;default:throw new Error("Unknown type")}N(e,a.name,r),r.buffer&&n(e,a,r.buffer.byteLength)}}(K||(K={})),M(0,0,{type:2,async deserialize({context:e,field:t,object:n}){let a=n[t.options.lengthField];if("string"==typeof a&&(a=Number.parseInt(a,10)),0===a){if(1!==t.options.emptyBehavior)return{value:void 0};switch(t.subType){case 0:return{value:new ArrayBuffer(0)};case 1:return{value:"",extra:new ArrayBuffer(0)};default:throw new Error("Unknown type")}}const r=await e.read(a);switch(t.subType){case 0:return{value:r};case 1:return{value:e.decodeUtf8(r),extra:r};default:throw new Error("Unknown type")}},getSize:()=>0,getDynamicSize:({field:e,object:t})=>t[e.options.lengthField],initialize({context:e,extra:t,field:n,object:a,value:r}){const i={};"string"==typeof r?(i.string=r,t&&(i.buffer=t)):i.buffer=r,F.initialize(a,n,i),K.initialize(a,n,i,e)},serialize({dataView:e,field:t,object:n,offset:a}){const r=T(n,t.name);new Uint8Array(e.buffer).set(new Uint8Array(r.buffer),a)}});const V={littleEndian:!1};class H{constructor(e=V){this._size=0,this.fields=[],this._extra={},this.array=(e,t,n)=>"length"in n?this.field({type:1,name:e,subType:t,options:n}):this.field({type:2,name:e,subType:t,options:n}),this.arrayBuffer=(e,t)=>this.array(e,0,t),this.string=(e,t)=>this.array(e,1,t),this.options={...V,...e}}get size(){return this._size}clone(){const e=new H(this.options);return e.fields=this.fields.slice(),e._size=this._size,e._extra=this._extra,e._afterParsed=this._afterParsed,e}field(e){const t=this.clone();t.fields.push(e);const n=R(e.type).getSize({field:e,options:this.options});return t._size+=n,t}number(e,t,n={},a){return this.field({type:0,name:e,subType:t,options:n})}uint8(e,t={},n){return this.number(e,0,t,n)}uint16(e,t={},n){return this.number(e,1,t,n)}int32(e,t={},n){return this.number(e,2,t,n)}uint32(e,t={},n){return this.number(e,3,t,n)}uint64(e,t={},n){return this.number(e,4,t,n)}int64(e,t={},n){return this.number(e,5,t,n)}extra(e){const t=this.clone();return t._extra={...t._extra,...Object.getOwnPropertyDescriptors(e)},t}afterParsed(e){const t=this.clone();return t._afterParsed=e,t}initializeField(e,t,n,a,r,i){n.initialize?n.initialize({context:e,extra:i,field:t,object:a,options:this.options,value:r}):(N(a,t.name,r),function(e,t){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:()=>T(e,t),set(n){N(e,t,n)}})}(a,t.name))}create(e,t){const n={[U]:{}};Object.defineProperties(n,this._extra);for(const a of this.fields){const r=R(a.type);this.initializeField(t,a,r,n,e[a.name])}return n}async deserialize(e){const t={[U]:{}};Object.defineProperties(t,this._extra);for(const n of this.fields){const a=R(n.type),{value:r,extra:i}=await a.deserialize({context:e,field:n,object:t,options:this.options});this.initializeField(e,n,a,t,r,i)}if(this._afterParsed){const e=this._afterParsed.call(t,t);if(e)return e}return t}serialize(e,t){const n=this.create(e,t);let a=this._size,r=[];for(let e=0;e<this.fields.length;e+=1){const i=this.fields[e],s=R(i.type);s.getDynamicSize?(r[e]=s.getDynamicSize({context:t,field:i,object:n,options:this.options}),a+=r[e]):r[e]=s.getSize({field:i,options:this.options})}const i=new ArrayBuffer(a),s=new DataView(i);let o=0;for(let e=0;e<this.fields.length;e+=1){const a=this.fields[e];R(a.type).serialize({context:t,dataView:s,field:a,object:n,offset:o,options:this.options}),o+=r[e]}return i}}class ${constructor(e=!1){this.list=[],this.blocking=e}wait(){if(!this.blocking&&(this.blocking=!0,0===this.list.length))return Promise.resolve();const e=new y.PromiseResolver;return this.list.push(e),e.promise}notify(){0!==this.list.length?this.list.pop().resolve():this.blocking=!1}dispose(){for(const e of this.list)e.reject(new Error("The AutoResetEvent has been disposed"));this.list.length=0}}let G=[];const q=[],Q="=".charCodeAt(0);let Y=0;function X(e,t){const n=e.charCodeAt(0),a=t.charCodeAt(0),r=a-n+1;for(let e=n;e<=a;e+=1)q.push(e);G.push({start:n,length:r,end:a,offset:n-Y}),Y+=r}function Z(e){const t=e.charCodeAt(0);let n=0,a=G.length-1,r=a>>1;for(;;){const e=G[r];if(t<e.start)a=r-1;else{if(!(t>e.end))return t-e.offset;n=r+1}r=n+a>>1}}function J(e,t,n,a,r){var i;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof ArrayBuffer)return e;let s,o,c,l,d;"number"!=typeof t?(s=0,o=e.byteLength,d=1):(s=t,"number"!=typeof n?(o=e.byteLength-s,d=2):(o=n,d=3));const u=o%3,h=(o+3-u)/3*4;let f,p=arguments[d];if(p){if(l=null!==(i=arguments[d+1])&&void 0!==i?i:0,p.byteLength-l<h)throw new Error("output buffer is too small");c=p instanceof ArrayBuffer?new Uint8Array(p):p,f="number"}else{const e=new ArrayBuffer(h);c=new Uint8Array(e),l=0,f="ArrayBuffer"}if(c instanceof ArrayBuffer)return c;if(e.buffer===c.buffer){const t=e.byteOffset+s,n=c.byteOffset+l;if(n<t-1){if(n+h>=t)throw new Error("input and output buffer can not be overlapping")}}let m=s+o-1,b=l+h-1;if(1===u){const t=e[m];m-=1,c[b]=Q,b-=1,c[b]=Q,b-=1,c[b]=q[(3&t)<<4],b-=1,c[b]=q[t>>2],b-=1}else if(2===u){const t=e[m];m-=1;const n=e[m];m-=1,c[b]=Q,b-=1,c[b]=q[(15&t)<<2],b-=1,c[b]=q[(3&n)<<4|t>>4],b-=1,c[b]=q[n>>2],b-=1}for(;m>=s;){const t=e[m];m-=1;const n=e[m];m-=1;const a=e[m];m-=1,c[b]=q[63&t],b-=1,c[b]=q[(15&n)<<2|t>>6],b-=1,c[b]=q[(3&a)<<4|n>>4],b-=1,c[b]=q[a>>2],b-=1}return"ArrayBuffer"===f?c.buffer:h}X("A","Z"),X("a","z"),X("0","9"),X("+","+"),X("/","/"),G=G.sort((e,t)=>e.end-t.end);const ee={maxWaitCount:1/0,highWaterMark:10,lowWaterMark:0};class te{constructor(e=ee){this.pullQueue=[],this.pushQueue=[],this.ended=!1,this.waterMark=0,this.pendingLowWaterEvent=!1,this.lowWaterEvent=new E,this.options={...ee,...e}}get onLowWater(){return this.lowWaterEvent.event}push(e,t=1){return!!this.ended||(this.pullQueue.length?(this.pullQueue.shift().resolve(e),!0):(this.pushQueue.push([e,t]),this.waterMark+=t,this.waterMark<this.options.highWaterMark||(this.pendingLowWaterEvent=!0,!1)))}next(){if(this.pushQueue.length){const[e,t]=this.pushQueue.shift();return this.waterMark-=t,this.pendingLowWaterEvent&&this.waterMark<=this.options.lowWaterMark&&this.lowWaterEvent.fire(),Promise.resolve(e)}if(this.ended)return Promise.reject(new Error("The EventQueue has already ended"));if(this.pullQueue.length===this.options.maxWaitCount-1)throw new Error("Max wait count exceeded");const e=new y.PromiseResolver;return this.pullQueue.push(e),e.promise}end(){let e;for(this.ended=!0;e=this.pullQueue.shift();)e.reject(new Error("The EventQueue has already ended"))}}class ne{constructor(e){this.readLock=new $,this.stream=e,this.queue=new te({highWaterMark:16384});const t=new $(!0);this.stream.onData(e=>{if(!this.queue.push(e,e.byteLength))return t.wait()}),this.stream.onClose(()=>{this.queue.end()}),this.queue.onLowWater(()=>{t.notify()})}get backend(){return this.stream.backend}get localId(){return this.stream.localId}get remoteId(){return this.stream.remoteId}async read(){await this.readLock.wait();try{return await this.queue.next()}finally{this.readLock.notify()}}write(e){return this.stream.write(e)}close(){this.stream.close()}}class ae{constructor(e){this.stream=e}async read(e){let t,n;if(this.buffer){const a=this.buffer;if(a.byteLength>e)return this.buffer=a.subarray(e),a.slice(0,e).buffer;t=new Uint8Array(e),t.set(a),n=a.byteLength,this.buffer=void 0}else{const a=await this.stream.read(e);if(a.byteLength===e)return a;if(a.byteLength>e)return this.buffer=new Uint8Array(a,e),a.slice(0,e);t=new Uint8Array(e),t.set(new Uint8Array(a),0),n=a.byteLength}for(;n<e;){const a=e-n,r=await this.stream.read(a);if(r.byteLength>a)return t.set(new Uint8Array(r,0,a),n),this.buffer=new Uint8Array(r,a),t.buffer;t.set(new Uint8Array(r),n),n+=r.byteLength}return t.buffer}close(){var e,t;null===(t=(e=this.stream).close)||void 0===t||t.call(e)}}class re extends ae{get backend(){return this.stream.backend}get localId(){return this.stream.localId}get remoteId(){return this.stream.remoteId}constructor(e){super(new ne(e))}write(e){return this.stream.write(e)}decodeUtf8(e){return this.backend.decodeUtf8(e)}encodeUtf8(e){return this.backend.encodeUtf8(e)}}function*ie(e,t){if("length"in e&&(e=new Uint8Array(e).buffer),e.byteLength<=t)return yield e;for(let n=0;n<e.byteLength;n+=t)yield e.slice(n,n+t)}class se extends O{constructor(e,t,n){super(),this.writeLock=this.addDisposable(new $),this.dataEvent=this.addDisposable(new k),this._closed=!1,this.closeEvent=this.addDisposable(new E),this.localId=e,this.remoteId=t,this.dispatcher=n}get backend(){return this.dispatcher.backend}get closed(){return this._closed}get onClose(){return this.closeEvent.event}async writeChunk(e){if(this._closed)throw new Error("Can not write after closed");await this.writeLock.wait(),await this.dispatcher.sendPacket(le.Write,this.localId,this.remoteId,e)}async write(e){for await(const t of ie(e,this.dispatcher.maxPayloadSize))await this.writeChunk(t)}ack(){this.writeLock.notify()}async close(){this._closed||(await this.dispatcher.sendPacket(le.Close,this.localId,this.remoteId),this._closed=!0)}dispose(){this._closed=!0,this.closeEvent.fire(),super.dispose()}}class oe{constructor(e){this.controller=e}get backend(){return this.controller.backend}get localId(){return this.controller.localId}get remoteId(){return this.controller.remoteId}get onData(){return this.controller.dataEvent.event}get onClose(){return this.controller.onClose}write(e){return this.controller.write(e)}close(){return this.controller.close()}}class ce extends O{constructor(e){super(),this.initializers=new v.a(1),this.streams=new Map,this.sendLock=new $,this.maxPayloadSize=0,this.calculateChecksum=!0,this.appendNullToServiceString=!0,this.packetEvent=this.addDisposable(new E),this.streamEvent=this.addDisposable(new E),this.errorEvent=this.addDisposable(new E),this._running=!1,this.backend=e}get onPacket(){return this.packetEvent.event}get onStream(){return this.streamEvent.event}get onError(){return this.errorEvent.event}get running(){return this._running}async receiveLoop(){try{for(;this._running;){const e=await he.read(this.backend);switch(e.command){case le.OK:this.handleOk(e);continue;case le.Close:if(0===e.arg0){this.initializers.reject(e.arg1,new Error("Stream open failed"));continue}if(this.streams.has(e.arg1)){this.streams.get(e.arg1).dispose(),this.streams.delete(e.arg1);continue}continue;case le.Write:this.streams.has(e.arg1)&&(await this.streams.get(e.arg1).dataEvent.fire(e.payload),await this.sendPacket(le.OK,e.arg1,e.arg0));continue;case le.Open:await this.handleOpen(e);continue}const t={handled:!1,packet:e};if(this.packetEvent.fire(t),!t.handled)return void this.dispose()}}catch(e){if(!this._running)return;this.errorEvent.fire(e)}}handleOk(e){this.initializers.resolve(e.arg1,e.arg0)||(this.streams.has(e.arg1)?this.streams.get(e.arg1).ack():this.sendPacket(le.Close,e.arg1,e.arg0))}async handleOpen(e){const[t]=this.initializers.add();this.initializers.resolve(t,void 0);const n=e.arg0,a=new se(t,n,this),r={handled:!1,packet:e,stream:new oe(a)};this.streamEvent.fire(r),r.handled?(this.streams.set(t,a),await this.sendPacket(le.OK,t,n)):await this.sendPacket(le.Close,0,n)}start(){this._running=!0,this.receiveLoop()}async createStream(e){this.appendNullToServiceString&&(e+="\0");const[t,n]=this.initializers.add();await this.sendPacket(le.Open,t,0,e);const a=await n,r=new se(t,a,this);return this.streams.set(r.localId,r),new oe(r)}async sendPacket(e,t,n,a){let r;if(r=1===arguments.length?e:{command:e,arg0:t,arg1:n,payload:"string"==typeof a?this.backend.encodeUtf8(a):a},r.payload&&r.payload.byteLength>this.maxPayloadSize)throw new Error("payload too large");try{await this.sendLock.wait();const e=he.create(r,this.calculateChecksum,this.backend);await he.write(e,this.backend)}finally{this.sendLock.notify()}}dispose(){this._running=!1;for(const e of this.streams.values())e.dispose();this.streams.clear(),super.dispose()}}var le;!function(e){e[e.Auth=1213486401]="Auth",e[e.Close=1163086915]="Close",e[e.Connect=1314410051]="Connect",e[e.OK=1497451343]="OK",e[e.Open=1313165391]="Open",e[e.Write=1163154007]="Write"}(le||(le={}));const de=new H({littleEndian:!0}).uint32("command",void 0).uint32("arg0").uint32("arg1").uint32("payloadLength").uint32("checksum").int32("magic"),ue=de.arrayBuffer("payload",{lengthField:"payloadLength"}).afterParsed(e=>{if(e[U].magic!==e.magic)throw new Error("Invalid command")});var he,fe,pe;(fe=he||(he={})).create=function(e,t,n){let a;return a=t&&e.payload?new Uint8Array(e.payload).reduce((e,t)=>e+t,0):0,ue.create({...e,checksum:a,magic:4294967295^e.command},n)},fe.read=async function(e){let t=await e.read(24);24!==t.byteLength&&(t=await e.read(24));let n=!1;const a=new ae({read:a=>n?e.read(a):(n=!0,t)});return ue.deserialize({read:a.read.bind(a),decodeUtf8:e.decodeUtf8.bind(e),encodeUtf8:e.encodeUtf8.bind(e)})},fe.write=async function(e,t){await t.write(de.serialize(e,t)),e.payload&&await t.write(e.payload)},function(e){e[e.Token=1]="Token",e[e.Signature=2]="Signature",e[e.PublicKey=3]="PublicKey"}(pe||(pe={}));const me=[async function*(e,t){for await(const n of e.iterateKeys()){if(t.arg0!==pe.Token)return;const e=I(n,t.payload);t=yield{command:le.Auth,arg0:pe.Signature,arg1:0,payload:e}}},async function*(e,t){if(t.arg0!==pe.Token)return;let n;for await(const t of e.iterateKeys()){n=t;break}n||(n=await e.generateKey());const a=((r=524)+3-r%3)/3*4;var r;const i=new ArrayBuffer(a+1);_(n,i),J(i,0,524,i),yield{command:le.Auth,arg0:pe.PublicKey,arg1:0,payload:i}}];class be{constructor(e,t){this.authenticators=e,this.backend=t}async*nextCore(e){var t;for(const n of this.authenticators){const a=n(this.backend,e);try{let n=await a.next();for(;!n.done;)e=yield n.value,n=await a.next(e)}finally{null===(t=a.return)||void 0===t||t.call(a)}}throw new Error("Cannot authenticate with device")}async next(e){this.iterator||(this.iterator=this.nextCore(e));return(await this.iterator.next(e)).value}dispose(){var e,t;null===(t=null===(e=this.iterator)||void 0===e?void 0:e.return)||void 0===t||t.call(e)}}class we extends O{constructor(e){super(),this.adb=e}}const ge=new H({littleEndian:!0}).uint32("version"),ye=new H({littleEndian:!0}).uint32("bpp").uint32("size").uint32("width").uint32("height").uint32("red_offset").uint32("red_length").uint32("blue_offset").uint32("blue_length").uint32("green_offset").uint32("green_length").uint32("alpha_offset").uint32("alpha_length").arrayBuffer("data",{lengthField:"size"}),ve=new H({littleEndian:!0}).uint32("bpp").uint32("colorSpace").uint32("size").uint32("width").uint32("height").uint32("red_offset").uint32("red_length").uint32("blue_offset").uint32("blue_length").uint32("green_offset").uint32("green_length").uint32("alpha_offset").uint32("alpha_length").arrayBuffer("data",{lengthField:"size"});const Ee=new H({littleEndian:!0}).string("length",{length:4}).string("content",{lengthField:"length"}),ke=Ee.afterParsed(e=>{throw new Error(e.content)});class Oe extends O{constructor(e){super(),this.localPortToHandler=new Map,this.deviceAddressToLocalPort=new Map,this.listening=!1,this.dispatcher=e,this.addDisposable(this.dispatcher.onStream(this.handleStream,this))}handleStream(e){if(e.handled)return;const t=this.dispatcher.backend.decodeUtf8(e.packet.payload),n=Number.parseInt(t.substring(4));this.localPortToHandler.has(n)&&(this.localPortToHandler.get(n).onStream(e.packet,e.stream),e.handled=!0)}async add(e,t,n){const a=await this.dispatcher.createStream(`reverse:forward:${e};tcp:${t}`),r=new re(a);if("OKAY"===this.dispatcher.backend.decodeUtf8(await r.read(4))){if(e.startsWith("tcp:")){const t=await Ee.deserialize(r);e="tcp:"+Number.parseInt(t.content,10)}return this.localPortToHandler.set(t,n),this.deviceAddressToLocalPort.set(e,t),e}return await ke.deserialize(r)}async list(){const e=await this.dispatcher.createStream("reverse:list-forward"),t=new re(e);return(await Ee.deserialize(t)).content.split("\n").map(e=>{const[t,n,a]=e.split(" ");return{deviceSerial:t,localName:n,remoteName:a}})}async remove(e){const t=await this.dispatcher.createStream("reverse:killforward:"+e),n=new re(t);"OKAY"===this.dispatcher.backend.decodeUtf8(await n.read(4))?this.deviceAddressToLocalPort.has(e)&&(this.localPortToHandler.delete(this.deviceAddressToLocalPort.get(e)),this.deviceAddressToLocalPort.delete(e)):await ke.deserialize(n)}async removeAll(){const e=await this.dispatcher.createStream("reverse:killforward-all"),t=new re(e);"OKAY"===this.dispatcher.backend.decodeUtf8(await t.read(4))?(this.deviceAddressToLocalPort.clear(),this.localPortToHandler.clear()):await ke.deserialize(t)}}var je;!function(e){e.List="LIST",e.Send="SEND",e.Lstat="STAT",e.Stat="STA2",e.Lstat2="LST2",e.Data="DATA",e.Done="DONE",e.Receive="RECV"}(je||(je={}));const Se=new H({littleEndian:!0}).string("id",{length:4}).uint32("arg"),Ce=Se.arrayBuffer("data",{lengthField:"arg"});async function xe(e,t,n){let a;a="number"==typeof n?Se.serialize({id:t,arg:n},e):"string"==typeof n?Ce.serialize({id:t,data:e.encodeUtf8(n)},e):Ce.serialize({id:t,data:n},e),await e.write(a)}var De;!function(e){e.Entry="DENT",e.Lstat="STAT",e.Stat="STA2",e.Lstat2="LST2",e.Done="DONE",e.Data="DATA",e.Ok="OKAY",e.Fail="FAIL"}(De||(De={}));class Le{constructor(e){this.id=De.Done,this.length=e}async deserialize(e){return await e.read(this.length),this}}const Ae=new H({littleEndian:!0}).uint32("messageLength").string("message",{lengthField:"messageLength"}).afterParsed(e=>{throw new Error(e.message)});async function Pe(e,t){const n=e.backend.decodeUtf8(await e.read(4));if(n===De.Fail&&await Ae.deserialize(e),t[n])return t[n].deserialize(e);throw new Error("Unexpected response id")}var _e;!function(e){e[e.Directory=4]="Directory",e[e.File=8]="File",e[e.Link=10]="Link"}(_e||(_e={}));const ze=new H({littleEndian:!0}).int32("mode").int32("size").int32("mtime").extra({id:De.Lstat,get type(){return this.mode>>12},get permission(){return 4095&this.mode}}).afterParsed(e=>{if(0===e.mode&&0===e.size&&0===e.mtime)throw new Error("lstat failed")});var Ie;!function(e){e[e.EACCES=13]="EACCES",e[e.EEXIST=17]="EEXIST",e[e.EFAULT=14]="EFAULT",e[e.EFBIG=27]="EFBIG",e[e.EINTR=4]="EINTR",e[e.EINVAL=22]="EINVAL",e[e.EIO=5]="EIO",e[e.EISDIR=21]="EISDIR",e[e.ELOOP=40]="ELOOP",e[e.EMFILE=24]="EMFILE",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENFILE=23]="ENFILE",e[e.ENOENT=2]="ENOENT",e[e.ENOMEM=12]="ENOMEM",e[e.ENOSPC=28]="ENOSPC",e[e.ENOTDIR=20]="ENOTDIR",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EPERM=1]="EPERM",e[e.EROFS=30]="EROFS",e[e.ETXTBSY=26]="ETXTBSY"}(Ie||(Ie={}));const Ue=new H({littleEndian:!0}).uint32("error",void 0,void 0).uint64("dev").uint64("ino").uint32("mode").uint32("nlink").uint32("uid").uint32("gid").uint64("size").uint64("atime").uint64("mtime").uint64("ctime").extra({id:De.Stat,get type(){return this.mode>>12},get permission(){return 4095&this.mode}}).afterParsed(e=>{if(e.error)throw new Error(Ie[e.error])}),Te={[De.Stat]:Ue},Ne={[De.Lstat]:ze},Fe={[De.Lstat2]:Ue};const Be=ze.afterParsed().uint32("nameLength").string("name",{lengthField:"nameLength"}).extra({id:De.Entry}),Re={[De.Entry]:Be,[De.Done]:new Le(Be.size)};const Me=new H({littleEndian:!0}).uint32("dataLength").arrayBuffer("data",{lengthField:"dataLength"}).extra({id:De.Data}),We={[De.Data]:Me,[De.Done]:new Le(Me.size)};const Ke=new H({littleEndian:!0}).uint32("unused"),Ve={[De.Ok]:Ke};async function He(e,t,n,a=_e.File<<12|438,r=Date.now()/1e3|0,i=65536,s){const o=`${t},${a.toString()}`;let c;await xe(e,je.Send,o),c="length"in n||"byteLength"in n?ie(n,i):async function*(e,t){let n=new Uint8Array(t),a=0;for await(let r of e){if(0!==a&&a+r.byteLength>=t){const e=t-a;if(n.set(new Uint8Array(r,0,e),a),yield n.buffer,n=new Uint8Array(t),a=0,!(r.byteLength>e))continue;r=r.slice(e)}if(r.byteLength>=t){let e=!1;for(const n of ie(r,t))n.byteLength!==t?(e=!0,r=n):yield n;if(!e)continue}n.set(new Uint8Array(r),a),a+=r.byteLength}0!==a&&(yield n.buffer.slice(0,a))}(n,i);let l=0;for await(const t of c)await xe(e,je.Data,t),l+=t.byteLength,null==s||s(l);await xe(e,je.Done,r),await Pe(e,Ve)}var $e,Ge;!function(e){e.StatV2="stat_v2"}($e||($e={}));class qe extends O{constructor(e,t){super(),this.sendLock=this.addDisposable(new $),this.adb=e,this.stream=new re(t)}get supportStat(){return this.adb.features.includes($e.StatV2)}async lstat(e){await this.sendLock.wait();try{return async function(e,t,n){let a,r;return n?(a=je.Lstat2,r=Fe):(a=je.Lstat,r=Ne),await xe(e,a,t),Pe(e,r)}(this.stream,e,this.supportStat)}finally{this.sendLock.notify()}}async stat(e){if(!this.supportStat)throw new Error("Not supported");await this.sendLock.wait();try{return async function(e,t){return await xe(e,je.Stat,t),Pe(e,Te)}(this.stream,e)}finally{this.sendLock.notify()}}async isDirectory(e){try{return await this.lstat(e+"/"),!0}catch(e){return!1}}async*opendir(e){await this.sendLock.wait();try{yield*async function*(e,t){for(await xe(e,je.List,t);;){const t=await Pe(e,Re);switch(t.id){case De.Entry:yield t;break;case De.Done:return;default:throw new Error("Unexpected response id")}}}(this.stream,e)}finally{this.sendLock.notify()}}async readdir(e){const t=[];for await(const n of this.opendir(e))t.push(n);return t}async*read(e){await this.sendLock.wait();try{yield*async function*(e,t){for(await xe(e,je.Receive,t);;){const t=await Pe(e,We);switch(t.id){case De.Data:yield t.data;break;case De.Done:return;default:throw new Error("Unexpected response id")}}}(this.stream,e)}finally{this.sendLock.notify()}}async write(e,t,n,a,r){await this.sendLock.wait();try{await He(this.stream,e,t,n,a,void 0,r)}finally{this.sendLock.notify()}}dispose(){super.dispose(),this.stream.close()}}class Qe extends we{async setPort(e){if(e<=0)throw new Error("Invalid port "+e);if(await this.adb.createStreamAndReadAll("tcpip:"+e)!==`restarting in TCP mode port: ${e}\n`)throw new Error("Invalid response")}async disable(){if("restarting in USB mode\n"!==await this.adb.createStreamAndReadAll("usb:"))throw new Error("Invalid response")}}!function(e){e.Product="ro.product.name",e.Model="ro.product.model",e.Device="ro.product.device",e.Features="features"}(Ge||(Ge={}));class Ye{constructor(e){this._connected=!1,this.backend=e,this.packetDispatcher=new ce(e),this.tcpip=new Qe(this),this.reverse=new Oe(this.packetDispatcher),e.onDisconnected(this.dispose,this)}get onDisconnected(){return this.backend.onDisconnected}get connected(){return this._connected}get name(){return this.backend.name}get product(){return this._product}get model(){return this._model}get device(){return this._device}get features(){return this._features}async connect(e=me){var t,n;await(null===(n=(t=this.backend).connect)||void 0===n?void 0:n.call(t)),this.packetDispatcher.maxPayloadSize=4096,this.packetDispatcher.calculateChecksum=!0,this.packetDispatcher.appendNullToServiceString=!0,this.packetDispatcher.start();const a=["shell_v2","cmd",$e.StatV2,"ls_v2","fixed_push_mkdir","apex","abb","fixed_push_symlink_timestamp","abb_exec","remount_shell","track_app","sendrecv_v2","sendrecv_v2_brotli","sendrecv_v2_lz4","sendrecv_v2_zstd","sendrecv_v2_dry_run_send"].join(","),r=new y.PromiseResolver,i=new be(e,this.backend),s=new j;s.add(this.packetDispatcher.onPacket(async e=>{e.handled=!0;const{packet:t}=e;try{switch(t.command){case le.Connect:this.packetDispatcher.maxPayloadSize=Math.min(1048576,t.arg1),Math.min(16777217,t.arg0)>=16777217&&(this.packetDispatcher.calculateChecksum=!1,this.packetDispatcher.appendNullToServiceString=!1),this.parseBanner(this.backend.decodeUtf8(t.payload)),r.resolve();break;case le.Auth:const n=await i.next(e.packet);await this.packetDispatcher.sendPacket(n);break;case le.Close:break;default:throw new Error("Device not in correct state. Reconnect your device and try again")}}catch(e){r.reject(e)}})),s.add(this.packetDispatcher.onError(e=>{r.reject(e)})),await this.packetDispatcher.sendPacket(le.Connect,16777217,1048576,`host::features=${a};\0`);try{await r.promise,this._connected=!0}finally{s.dispose()}}parseBanner(e){this._features=[];const t=e.split("::");if(t.length>1){const e=t[1];for(const t of e.split(";")){if(!t)continue;const e=t.split("=");if(2!==e.length)continue;const[n,a]=e;switch(n){case Ge.Product:this._product=a;break;case Ge.Model:this._model=a;break;case Ge.Device:this._device=a;break;case Ge.Features:this._features=a.split(",")}}}}shell(){return this.createStream("shell:")}spawn(e,...t){return this.createStream(`shell:${e} ${t.join(" ")}`)}exec(e,...t){return this.createStreamAndReadAll(`shell:${e} ${t.join(" ")}`)}async getProp(e){return(await this.exec("getprop",e)).trim()}async sync(){const e=await this.createStream("sync:");return new qe(this,e)}async framebuffer(){return async function(e){const t=await e.createStream("framebuffer:"),n=new re(t),{version:a}=await ge.deserialize(n);switch(a){case 1:return ye.deserialize(n);case 2:return ve.deserialize(n);default:throw new Error("Unknown FrameBuffer version")}}(this)}async createStream(e){return this.packetDispatcher.createStream(e)}async createStreamAndReadAll(e){const t=await this.createStream(e),n=new y.PromiseResolver;let a="";return t.onData(e=>{a+=this.backend.decodeUtf8(e)}),t.onClose(()=>n.resolve(a)),n.promise}async dispose(){this.packetDispatcher.dispose(),await this.backend.dispose()}}class Xe{constructor(e){this.callback=e,window.navigator.usb.addEventListener("connect",e),window.navigator.usb.addEventListener("disconnect",e)}dispose(){window.navigator.usb.removeEventListener("connect",this.callback),window.navigator.usb.removeEventListener("disconnect",this.callback)}}const Ze={classCode:255,subclassCode:66,protocolCode:1},Je=new TextEncoder,et=new TextDecoder;function tt(e){return Je.encode(e)}function nt(e){return et.decode(e)}class at{constructor(e){this.disconnectEvent=new E,this.onDisconnected=this.disconnectEvent.event,this.handleDisconnect=e=>{e.device===this._device&&this.disconnectEvent.fire()},this._device=e,window.navigator.usb.addEventListener("disconnect",this.handleDisconnect)}static async getDevices(){return(await window.navigator.usb.getDevices()).map(e=>new at(e))}static async requestDevice(){try{const e=await navigator.usb.requestDevice({filters:[Ze]});return new at(e)}catch(e){switch(e.name){case"NotFoundError":return;default:throw e}}}get serial(){return this._device.serialNumber}get name(){return this._device.productName}async connect(){var e;this._device.opened||await this._device.open();for(const t of this._device.configurations)for(const n of t.interfaces)for(const a of n.alternates)if(a.interfaceSubclass===Ze.subclassCode&&a.interfaceClass===Ze.classCode&&a.interfaceSubclass===Ze.subclassCode){(null===(e=this._device.configuration)||void 0===e?void 0:e.configurationValue)!==t.configurationValue&&await this._device.selectConfiguration(t.configurationValue),n.claimed||await this._device.claimInterface(n.interfaceNumber),n.alternate.alternateSetting!==a.alternateSetting&&await this._device.selectAlternateInterface(n.interfaceNumber,a.alternateSetting);for(const e of a.endpoints)switch(e.direction){case"in":if(this._inEndpointNumber=e.endpointNumber,void 0!==this._outEndpointNumber)return;break;case"out":if(this._outEndpointNumber=e.endpointNumber,void 0!==this._inEndpointNumber)return}}throw new Error("Unknown error")}*iterateKeys(){const e=window.localStorage.getItem("private-key");e&&(yield function(e){let t;t="="===e[e.length-2]?2:"="===e[e.length-1]?1:0;const n=new Uint8Array(e.length/4*3-t);let a=0,r=0;for(;a<e.length-(0!==t?4:0);){const t=Z(e[a]);a+=1;const i=Z(e[a]);a+=1;const s=Z(e[a]);a+=1;const o=Z(e[a]);a+=1,n[r]=t<<2|(48&i)>>4,r+=1,n[r]=(15&i)<<4|(60&s)>>2,r+=1,n[r]=(3&s)<<6|o,r+=1}if(1===t){const t=Z(e[a]);a+=1;const i=Z(e[a]);a+=1;const s=Z(e[a]);n[r]=t<<2|(48&i)>>4,r+=1,n[r]=(15&i)<<4|(60&s)>>2}else if(2===t){const t=Z(e[a]);a+=1;const i=Z(e[a]);n[r]=t<<2|(48&i)>>4}return n.buffer}(e))}async generateKey(){const{privateKey:e}=await crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-1"},!0,["sign","verify"]),t=await crypto.subtle.exportKey("pkcs8",e);return window.localStorage.setItem("private-key",nt(J(t))),t}encodeUtf8(e){return tt(e)}decodeUtf8(e){return nt(e)}async write(e){await this._device.transferOut(this._outEndpointNumber,e)}async read(e){const t=await this._device.transferIn(this._inEndpointNumber,e);"stall"===t.status&&await this._device.clearHalt("in",this._inEndpointNumber);const{buffer:n}=t.data;return n}async dispose(){window.navigator.usb.removeEventListener("disconnect",this.handleDisconnect),this.disconnectEvent.dispose(),await this._device.close()}}var rt=n("ZZCj"),it=n("sGVl"),st=n("jEFs"),ot=n("62r0");function ct(e){return t=>(t.displayName=e,Object(o.memo)(t))}function lt(e){return t=>ct(e)(c.a.forwardRef(t))}const dt={root:{margin:"-20px -20px 0 -20px",borderBottom:"1px solid rgb(243, 242, 241)"}},ut=ct("CommandBar")(e=>c.a.createElement(a.a,{styles:dt},c.a.createElement(ot.a,Object.assign({},e))));var ht=n("x2vQ");const ft={position:"absolute",top:0,left:0,width:"100%",height:"100%",visibility:"hidden"},pt=lt("ResizeObserver")(({onResize:e,style:t,children:n,...a},r)=>{const i=Object(o.useRef)(e);i.current=e;const s=Object(o.useRef)(null),l=Object(ht.a)()(r,s),d=Object(o.useCallback)(()=>{const{width:e,height:t}=s.current.getBoundingClientRect();i.current(e,t)},[]),u=Object(o.useCallback)(e=>{e&&e.contentWindow.addEventListener("resize",d)},[]),h=c.a.useMemo(()=>t?t.position?t:{...t,position:"relative"}:{position:"relative"},[t]);return c.a.createElement("div",Object.assign({ref:l,style:h},a),c.a.createElement("iframe",{ref:u,style:ft}),n)}),mt=lt("DeviceView")(({width:e,height:t,children:n},r)=>{const[i,s]=Object(o.useState)(0),[l,d]=Object(o.useState)(0),[u,h]=Object(o.useState)(1),f=Object(o.useCallback)((e,t)=>{s(e),d(t)},[]);Object(o.useEffect)(()=>{if(0===e||0===i)return void h(1);h(e/t>i/l?i/e:l/t)},[e,t,i,l]);const p=Object(o.useRef)(null);return Object(o.useImperativeHandle)(r,()=>({enterFullscreen(){p.current.requestFullscreen()}}),[]),c.a.createElement(a.a,{grow:!0},c.a.createElement(pt,{ref:p,style:{position:"relative",width:"100%",height:"100%",backgroundColor:"black"},onResize:f},c.a.createElement("div",{style:{position:"absolute",left:"50%",top:"50%",transform:`scale(${u}) translate(-50%, -50%)`,transformOrigin:"top left"}},n)))});var bt=n("3mns");const wt=ct("ExternalLink")(({href:e,spaceBefore:t,spaceAfter:n,children:a})=>c.a.createElement(c.a.Fragment,null,t&&" ",c.a.createElement(bt.a,{href:e,target:"_blank",rel:"noopener"},null!=a?a:e),n&&" "));var gt=n("6Evp");const yt=[" B"," KB"," MB"," GB"];function vt(e){let t=0;for(;t<yt.length&&e>1024;)t+=1,e/=1024;return e.toLocaleString(void 0,{maximumFractionDigits:2})+yt[t]}function Et(e,t,n){if(0!==t)return`${vt(e)} of ${vt(t)} (${vt(n)}/s)`}function kt(e){const t=Object(o.useRef)(e);t.current=e;const[n,a]=Object(o.useState)(e),[r,i]=Object(o.useState)(0),{setInterval:s}=Object(gt.a)();return Object(o.useEffect)(()=>{s(()=>{a(e=>(i(t.current-e),t.current))},1e3)},[]),[n,r]}function Ot(e){return new Promise(t=>{window.setTimeout(t,e)})}const jt=c.a.createContext({show(){}});var St=ct("ErrorDialogProvider")(e=>{const[t,{setTrue:n,setFalse:a}]=Object(st.a)(!1),[r,i]=Object(o.useState)(),s=Object(o.useMemo)(()=>({show(e){i(e),n()}}),[]);return c.a.createElement(jt.Provider,{value:s},e.children,c.a.createElement(w.a,{hidden:!t,dialogContentProps:{type:rt.a.normal,title:"Error",subText:r}},c.a.createElement(it.a,null,c.a.createElement(p.a,{text:"OK",onClick:a}))))});const Ct={dropdown:{width:242}};var xt=ct("Connect")(({device:e,onDeviceChange:t})=>{const{show:n}=Object(o.useContext)(jt),[i,s]=Object(o.useState)([]),[l,d]=Object(o.useState)();Object(o.useEffect)(()=>{async function e(){const e=await at.getDevices(),t=e.map(e=>({key:e.serial,text:`${e.serial} ${e.name?`(${e.name})`:""}`,data:e}));s(t),d(t=>t&&e.some(e=>e.serial===t.serial)?t:e[0])}e();const t=new Xe(e);return()=>t.dispose()},[]);const u=Object(o.useCallback)(async()=>{const e=await at.requestDevice();e&&s(t=>{for(const n of t)if(n.key===e.serial)return d(n.data),t;return d(e),[...t,{key:e.serial,text:`${e.serial} ${e.name?`(${e.name})`:""}`,data:e}]})},[]),[h,y]=Object(o.useState)(!1),v=Object(o.useCallback)(async()=>{try{if(l){const e=new Ye(l);try{y(!0),await e.connect(),t(e)}catch(t){throw e.dispose(),t}}}catch(e){n(e.message)}finally{y(!1)}},[l,t]),E=Object(o.useCallback)(async()=>{try{await e.dispose(),t(void 0)}catch(e){n(e.message)}},[e]);return Object(o.useEffect)(()=>null==e?void 0:e.onDisconnected(()=>{t(void 0)}),[e,t]),c.a.createElement(r.a,{tokens:{childrenGap:8,padding:"0 0 8px 8px"}},c.a.createElement(f.a,{disabled:!!e||0===i.length,label:"Available devices",placeholder:"No available devices",options:i,styles:Ct,dropdownWidth:300,selectedKey:null==l?void 0:l.serial,onChange:(e,t)=>{d(null==t?void 0:t.data)}}),e?c.a.createElement(b.a,{text:"Disconnect",onClick:E}):c.a.createElement(r.a,{horizontal:!0,tokens:{childrenGap:8}},c.a.createElement(a.a,{grow:!0,shrink:!0},c.a.createElement(p.a,{text:"Connect",disabled:!l,primary:!!l,styles:{root:{width:"100%"}},onClick:v})),c.a.createElement(a.a,{grow:!0,shrink:!0},c.a.createElement(m.a,{content:"WebADB can't connect to anything without your explicit permission."},c.a.createElement(b.a,{text:"Add device",primary:!l,styles:{root:{width:"100%"}},onClick:u})))),c.a.createElement(w.a,{hidden:!h,dialogContentProps:{title:"Connecting...",subText:"Please authorize the connection on your device"}},c.a.createElement(g.a,null)))}),Dt=n("SWC3");const Lt={tokens:{childrenGap:8,padding:20},verticalFill:!0,className:Dt.a.slideUpIn10,styles:{root:{overflow:"auto"}}},At=ct("CacheRoute")(e=>{const t=Object(u.f)(e),n=Object(o.useRef)(!1);!n.current&&t&&(n.current=!0);const a=Object(o.useMemo)(()=>({...Lt,styles:Object(Dt.q)(Lt.styles,{root:{display:t?"flex":"none"}})}),[!!t]);return e.noCache&&!t?null:n.current?c.a.createElement(r.a,Object.assign({},a),c.a.Children.map(e.children,e=>c.a.isValidElement(e)?c.a.cloneElement(e,{...e.props,visible:!!t}):e)):null}),Pt=ct("CacheSwitch")(e=>{const t=Object(u.e)();let n,a,r=Object(u.f)(),i=[];return c.a.Children.forEach(e.children,e=>{var s;if(c.a.isValidElement(e)){const o=e.type===At;if(o&&i.push(e),a)return;const c=null!==(s=e.props.path)&&void 0!==s?s:e.props.from,l=c?Object(u.d)(t.pathname,{...e.props,path:c}):r;l&&(a=l,n=o?void 0:e)}}),c.a.createElement(c.a.Fragment,null,i,n?c.a.cloneElement(n,{location:t,computedMatch:a}):null)});var _t=n("DeEv"),zt=n("IDeG"),It=n("9BiO"),Ut=n("JwHi"),Tt=n("zv84"),Nt=n("t/Ec"),Ft=n("XIMn"),Bt=n("TkDl"),Rt=n("9z8q"),Mt=n("aupw"),Wt=n("jsqa"),Kt=n("KWRb"),Vt=n("X0IQ"),Ht=n("8weS"),$t=n("6SDC"),Gt=n("33yf"),qt=n.n(Gt),Qt=n("Nxe8"),Yt=n.n(Qt);function Xt(e){return{...e,key:e.name}}Object(Kt.a)(),Yt.a.mitm="streamsaver/mitm.html";const Zt=Object(Dt.D)({name:{cursor:"pointer","&:hover":{textDecoration:"underline"}}}),Jt=(e,t)=>e&&t?t({...e,styles:Object(Dt.q)(e.styles,{root:{paddingTop:0}})}):null;function en(e){return new ReadableStream({async pull(t){const{desiredSize:n}=t;if(!n||n<0)return;let a=0;for(;a<n;){const n=await e.next();if(n.done)return void t.close();t.enqueue(new Uint8Array(n.value)),a+=n.value.byteLength}}})}function tn(e,t){let n=e.toLocaleLowerCase().localeCompare(t.toLocaleLowerCase());return 0!==n?n:e.localeCompare(t)}const nn=ct("FileManager")(({device:e})=>{const{show:t}=Object(o.useContext)(jt),[n,r]=Object(o.useState)("/"),i=Object(o.useRef)(n);i.current=n;const s=Object(o.useMemo)(()=>{let e="";const t=n.split("/").filter(Boolean).map(t=>(e+="/"+t,{key:e,text:t,onClick:(e,t)=>{t&&r(t.key)}}));return t.unshift({key:"/",text:"Device",onClick:()=>r("/")}),t[t.length-1].isCurrentItem=!0,t[t.length-1].onClick=void 0,t},[n]),[l,d]=Object(o.useState)([]),[u,h]=Object(o.useState)(!1),f=Object(o.useRef)(null),p=Object(o.useCallback)(async()=>{var t;if(d([]),!e)return void r("/");h(!0);const a=await e.sync(),s=[],o=[],c=setInterval(()=>{d(s.slice())},1e3);try{let e=Date.now();for await(const t of a.opendir(n)){if(n!==i.current)break;if("."===t.name||".."===t.name)continue;t.type===_e.Link?o.push(t):s.push(Xt(t));const a=Date.now();a-e>16&&(await Ot(0),e=a)}for(const e of o)await a.isDirectory(qt.a.resolve(n,e.name))||(e.mode=_e.File<<12|e.permission,e.size=0,Xt(e)),s.push(Xt(e));d(s),null===(t=f.current)||void 0===t||t.scrollToIndex(0)}finally{n===i.current&&h(!1),clearInterval(c),a.dispose()}},[e,n]);Object(o.useEffect)(()=>{p()},[p]);const[m,b]=Object(o.useState)([]),[y,v]=Object(o.useState)("name"),[E,k]=Object(o.useState)(!1);Object(o.useEffect)(()=>{const e=l.slice();e.sort((e,t)=>{const n=e.type===_e.File?1:0,a=t.type===_e.File?1:0;let r;if(n!==a)r=n-a;else{const n=e[y],a=t[y];r=n===a?tn(e.name,t.name):"string"==typeof n?tn(n,a):n<a?-1:1}return E&&(r*=-1),r}),b(e)},[l,y,E]);const O=Object(o.useMemo)(()=>{const e=[{key:"type",name:"File Type",iconName:"Page",isIconOnly:!0,minWidth:20,maxWidth:20,isCollapsible:!0,onRender(e){switch(e.type){case _e.Link:return c.a.createElement(_t.a,Object.assign({},Object(Vt.a)({size:20,type:Ht.a.linkedFolder})));case _e.Directory:return c.a.createElement(_t.a,Object.assign({},Object(Vt.a)({size:20,type:Ht.a.folder})));case _e.File:return c.a.createElement(_t.a,Object.assign({},Object(Vt.a)({size:20,extension:qt.a.extname(e.name)})));default:return c.a.createElement(_t.a,Object.assign({},Object(Vt.a)({size:20,extension:"txt"})))}}},{key:"name",name:"Name",minWidth:0,isRowHeader:!0,onRender:e=>c.a.createElement("span",{className:Zt.name,"data-selection-invoke":!0},e.name)},{key:"permission",name:"Permission",minWidth:0,isCollapsible:!0,onRender:e=>`${(e.mode>>6&4).toString(8)}${(e.mode>>3&4).toString(8)}${(4&e.mode).toString(8)}`},{key:"size",name:"Size",minWidth:0,isCollapsible:!0,onRender:e=>e.type===_e.File?vt(e.size):""},{key:"mtime",name:"Last Modified Time",minWidth:150,isCollapsible:!0,onRender:e=>new Date(1e3*e.mtime).toLocaleString()}];for(const t of e)t.onColumnClick=(e,t)=>{y===t.key?k(!E):(v(t.key),k(!1))},t.key===y&&(t.isSorted=!0,t.isSortedDescending=E);return e},[y,E]),[j,S]=Object(o.useState)(),C=Object(o.useCallback)(async t=>{const n=await e.sync();try{const e=en(n.read(t)),a=new Response(e),r=await a.blob(),i=window.URL.createObjectURL(r);S(i)}finally{n.dispose()}},[e]),x=Object(o.useCallback)(()=>{S(void 0)},[]),D=Object(o.useCallback)(e=>{switch(e.type){case _e.Link:case _e.Directory:r(qt.a.resolve(n,e.name));break;case _e.File:switch(qt.a.extname(e.name)){case".jpg":case".png":case".svg":case".gif":C(qt.a.resolve(n,e.name))}}},[n,C]),[L,A]=Object(o.useState)([]),P=Object($t.a)(()=>new zt.a({onSelectionChanged(){const e=P.getSelection();A(e)}})),[_,z]=Object(o.useState)(!1),[I,U]=Object(o.useState)(""),[T,N]=Object(o.useState)(0),[F,B]=Object(o.useState)(0),[R,M]=kt(T),W=Object(o.useCallback)(async a=>{const r=await e.sync();try{const e=qt.a.resolve(n,a.name);z(!0),U(a.name),B(a.size),await r.write(e,async function*(e){for(let t=0;t<e.size;t+=65536)yield e.slice(t,t+65536,e.type).arrayBuffer()}(a),_e.File<<12|438,a.lastModified/1e3,N)}catch(e){t(e.message)}finally{r.dispose(),p(),z(!1)}},[n,e]),[K,V]=Object(o.useState)([]);Object(o.useEffect)(()=>{let a=[];switch(L.length){case 0:a.push({key:"upload",text:"Upload",iconProps:{iconName:"Upload"},disabled:!e,onClick(){const e=document.createElement("input");return e.type="file",e.onchange=async()=>{var t;if(null===(t=e.files)||void 0===t?void 0:t.length)for(let t=0;t<e.files.length;t++){const n=e.files.item(t);await W(n)}},e.click(),!1}});break;case 1:L[0].type===_e.File&&a.push({key:"download",text:"Download",iconProps:{iconName:"Download"},onClick:()=>((async()=>{const a=await e.sync();try{const e=qt.a.resolve(n,L[0].name),t=en(a.read(e)),r=Yt.a.createWriteStream(L[0].name,{size:L[0].size});await t.pipeTo(r)}catch(e){t(e.message)}finally{a.dispose()}})(),!1)});default:a.push({key:"delete",text:"Delete",iconProps:{iconName:"Delete"},onClick:()=>((async()=>{try{for(const a of L){const r=await e.exec("rm","-rf",`"${qt.a.resolve(n,a.name)}"`);if(r)return void t(r)}}catch(e){t(e.message)}finally{p()}})(),!1)})}V(a)},[L,e,n]);const[H,$]=Object(o.useState)(),G=Object(o.useCallback)((e,t,n)=>!!n&&(K.length&&$(n),!1),[e,K]),q=c.a.useCallback(()=>{$(void 0)},[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ut,{items:K}),c.a.createElement(a.a,{grow:!0,styles:{root:{margin:"-8px -20px -20px -20px",padding:"8px 20px 20px 20px",minHeight:0}}},c.a.createElement(It.a,{selection:P},c.a.createElement(Ut.a,{items:s}),c.a.createElement(Tt.a,{componentRef:f,items:m,columns:O,setKey:n,selection:P,layoutMode:Nt.e.justified,enableShimmer:u&&0===l.length,onItemInvoked:D,onItemContextMenu:G,onRenderDetailsHeader:Jt,usePageCache:!0})),j&&c.a.createElement(Ft.a,null,c.a.createElement(Bt.a,{onClick:x},c.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},c.a.createElement("img",{src:j,style:{maxWidth:"100%",maxHeight:"100%"}})))),c.a.createElement(Rt.a,{items:K,hidden:!H,directionalHint:Mt.a.bottomLeftEdge,target:H,onDismiss:q,contextualMenuItemAs:e=>c.a.createElement(Wt.a,Object.assign({},e,{hasIcons:!1}))}),c.a.createElement(w.a,{hidden:!_,dialogContentProps:{title:"Uploading...",subText:I}},c.a.createElement(g.a,{description:Et(R,F,M),percentComplete:T/F}))))}),an=ct("FrameBuffer")(({device:e})=>{const{show:t}=Object(o.useContext)(jt),n=Object(o.useRef)(null),[a,r]=Object(o.useState)(0),[i,s]=Object(o.useState)(0),l=Object(o.useCallback)(()=>{e&&async function(){try{const t=window.performance.now(),a=await e.framebuffer(),i=window.performance.now();console.log("time",i-t);const{width:o,height:c}=a,l=n.current;if(!l)return;r(o),s(c),l.width=o,l.height=c;const d=l.getContext("2d"),u=new ImageData(new Uint8ClampedArray(a.data),o,c);d.putImageData(u,0,0)}catch(e){t(e.message)}}()},[e]),d=Object(o.useMemo)(()=>[{key:"start",disabled:!e,iconProps:{iconName:"Camera"},text:"Capture",onClick:l}],[e]),u=Object(o.useMemo)(()=>[{key:"info",iconProps:{iconName:"Info"},iconOnly:!0,tooltipHostProps:{content:"Use ADB FrameBuffer command to capture a full-size, high-resolution screenshot.",calloutProps:{calloutMaxWidth:250}}}],[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ut,{items:d,farItems:u}),c.a.createElement(mt,{width:a,height:i},c.a.createElement("canvas",{ref:n})))});var rn=n("RyIQ"),sn=n("hR4L");const on=Object(Dt.D)({callout:{padding:"8px 12px"}}),cn={root:{fontWeight:"600"}},ln=ct("CopyLink")(({href:e})=>{const t=Object(o.useRef)(null),[n,{setTrue:a,setFalse:r}]=Object(st.a)(!1),i=Object(o.useCallback)(n=>{navigator.clipboard.writeText(e),t.current=n.target,a(),setTimeout(r,3e3)},[e]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(bt.a,{onClick:i},e),c.a.createElement(rn.a,{directionalHint:Mt.a.topCenter,hidden:!n,target:t,onDismiss:r},c.a.createElement("div",{className:on.callout},"Link copied. Open a new tab and paste into address bar.")))}),dn=ct("Intro")(()=>c.a.createElement(c.a.Fragment,null,c.a.createElement(sn.a,{block:!0},"This page is a demo of my",c.a.createElement(wt,{href:"https://github.com/yume-chan/ya-webadb/",spaceBefore:!0,spaceAfter:!0},"WebADB"),"library, which can connect to your Android devices with the",c.a.createElement(wt,{href:"https://developer.mozilla.org/en-US/docs/Web/API/USB",spaceBefore:!0,spaceAfter:!0},"WebUSB"),"API."),c.a.createElement(sn.a,{block:!0},"The latest version of Google Chrome (or Microsoft Edge) is recommended for best compatibility."),c.a.createElement(sn.a,{block:!0,styles:cn},"Windows user?"),c.a.createElement(sn.a,{block:!0},"The experimental new backend is required. Enable from  "," ",c.a.createElement(ln,{href:"chrome://flags/#new-usb-backend"}),"."),c.a.createElement(sn.a,{block:!0,styles:cn},'Got "Unable to claim interface" error?'),c.a.createElement(sn.a,{block:!0},"Only one software can connect to your device at a time.",c.a.createElement("br",null),"1. Make sure ADB server is not running (run `adb kill-server` to stop it).",c.a.createElement("br",null),"2. Make sure no other Android management tools are running"),c.a.createElement(sn.a,{block:!0,styles:cn},'Got "Access denied" error?'),c.a.createElement(sn.a,{block:!0},"If you have a Samsung device, it's caused by the custom driver. See",c.a.createElement(wt,{href:"https://bugs.chromium.org/p/chromium/issues/detail?id=1127206",spaceBefore:!0})),c.a.createElement(sn.a,{block:!0,styles:cn},"Can I connect my device wirelessly (ADB over WiFi)?"),c.a.createElement(sn.a,{block:!0},"No. Web browsers doesn't support TCP connections.",c.a.createElement("br",null),"Or maybe, with",c.a.createElement(wt,{href:"https://github.com/novnc/websockify",spaceBefore:!0,spaceAfter:!0},"websockify"),"running on your device and a WebSocket backend for WebADB.")));var un=n("yKRw"),hn=n.n(un);const fn={childrenGap:8},pn=(new H).uint8("type",void 0,void 0),mn=(new H).uint8("type",void 0,2).uint8("action",void 0,void 0).uint64("pointerId").uint32("pointerX").uint32("pointerY").uint16("screenWidth").uint16("screenHeight").uint16("pressure").uint32("buttons");var bn=n.p+"ea3766d03fb8fef9c84c5480121c91e1.bin";class wn{constructor(e){this._downloaded=0,this._total=0,this.progressEvent=new E,this.promise=this.fetch(e)}get downloaded(){return this._downloaded}get total(){return this._total}get onProgress(){return this.progressEvent.event}async fetch(e){var t;const n=await window.fetch(e);this._total=Number.parseInt(null!==(t=n.headers.get("Content-Length"))&&void 0!==t?t:"0",10),this.progressEvent.fire([this._downloaded,this._total]);const a=n.body.getReader(),r=[];for(;;){const e=await a.read();if(e.done)break;r.push(e.value),this._downloaded+=e.value.byteLength,this.progressEvent.fire([this._downloaded,this._total])}this._total=r.reduce((e,t)=>e+t.byteLength,0);const i=new Uint8Array(this._total);let s=0;for(const e of r)i.set(e,s),s+=e.byteLength;return i.buffer}}let gn;const yn=(new H).uint16("width").uint16("height"),vn=(new H).int64("pts").uint32("size").arrayBuffer("data",{lengthField:"size"}),En=BigInt(-1);async function kn(e,t){let n,a=BigInt(0);try{for(;;){const{pts:r,data:i}=await vn.deserialize(e);if(r===En){n=i;continue}let s;n?(s=new Uint8Array(n.byteLength+i.byteLength),s.set(new Uint8Array(n)),s.set(new Uint8Array(i),n.byteLength),n=void 0):s=new Uint8Array(i);const o=Number(r-a)/1e3;a=r,t.feed({video:s,duration:o})}}catch(e){return void t.destroy()}}const On=(new H).uint32("length").string("content",{lengthField:"length"});async function jn(e){try{for(;;){const t=await e.read(1);switch(new Uint8Array(t)[0]){case 0:const{content:t}=await On.deserialize(e);window.navigator.clipboard.writeText(t);break;default:throw new Error("unknown control message type")}}}catch(e){return}}async function Sn(e,t){try{for(;;){const n=await t.next();let a;switch(n.type){case 2:a=mn.serialize(n,e);break;default:a=pn.serialize(n,e)}await e.write(a)}}catch(e){return}}const Cn=ct("Scrcpy")(({device:e})=>{const{show:t}=Object(o.useContext)(jt),[n,i]=Object(o.useState)(!1),s=Object(o.useRef)(null),[l,d]=Object(o.useState)(0),[u,h]=Object(o.useState)(0),f=Object(o.useCallback)(e=>{s.current=e,e&&(e.onresize=()=>{d(e.videoWidth),h(e.videoHeight)},e.addEventListener("touchstart",e=>{e.preventDefault()}),e.addEventListener("contextmenu",e=>{e.preventDefault()}),e.addEventListener("pause",()=>{console.log("???"),e.play()}))},[]),[p,m]=Object(o.useState)(!1),[b,y]=Object(o.useState)(0),[v,E]=Object(o.useState)(0),[k,O]=kt(v),[j,S]=Object(o.useState)(0),[C,x]=kt(j),D=Object(o.useRef)(),L=Object(o.useRef)(),A=Object(o.useRef)(),P=Object(o.useCallback)(()=>{e&&(async()=>{try{y(0),E(0),S(0),m(!0);const t=await(n=([e,t])=>{E(e),y(t)},gn||(gn=new wn(bn)),n&&(gn.onProgress(n),n([gn.downloaded,gn.total])),gn.promise),a=await e.sync();await a.write("/data/local/tmp/scrcpy-server.jar",t,void 0,void 0,S);const r=new te,o=await e.reverse.add("localabstract:scrcpy",27183,{onStream(e,t){r.push(t)}}),c=await e.spawn("CLASSPATH=/data/local/tmp/scrcpy-server.jar","app_process","/","com.genymobile.scrcpy.Server","1.16","debug","0","8000000","0",-1..toString(),"false","-","true","true","0","true","true","-");c.onData(t=>{console.log(e.backend.decodeUtf8(t))}),c.onClose(()=>{console.log("server stopped")});const l=new re(await r.next()),d=new re(await r.next());A.current=d,e.reverse.remove(o),await l.read(64),await yn.deserialize(l);const u=new hn.a({node:s.current,mode:"video",flushingTime:0});D.current=c,m(!1),i(!0),L.current=new te,await Promise.all([kn(l,u),jn(d),Sn(d,L.current)]),_()}catch(e){t(e.message)}finally{m(!1)}var n})()},[e]),_=Object(o.useCallback)(()=>{D.current&&(L.current.end(),D.current.close(),D.current=void 0,i(!1))},[]),z=Object(o.useRef)(null),I=Object(o.useMemo)(()=>{const t=[];return n?t.push({key:"stop",iconProps:{iconName:"Stop"},text:"Stop",onClick:_}):t.push({key:"start",disabled:!e,iconProps:{iconName:"Play"},text:"Start",onClick:P}),t.push({key:"fullscreen",disabled:!n,iconProps:{iconName:"Fullscreen"},text:"Fullscreen",onClick:()=>{var e;null===(e=z.current)||void 0===e||e.enterFullscreen()}}),t},[e,n,P]),U=Object(o.useMemo)(()=>[{key:"info",iconProps:{iconName:"Info"},iconOnly:!0,tooltipHostProps:{content:c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,c.a.createElement(wt,{href:"https://github.com/Genymobile/scrcpy",spaceAfter:!0},"Scrcpy"),"developed by genymobile can display the screen with low latency (1~2 frames) and control the device, all without root access."),c.a.createElement("div",null,"I reimplemented the protocol in JavaScript, it's used with a pre-built server binary from Genymobile's GitHub.")),calloutProps:{calloutMaxWidth:300}}}],[]),T=Object(o.useCallback)((e,t)=>{t.preventDefault(),t.stopPropagation();const n=t.currentTarget.getBoundingClientRect(),a=t.clientX-n.x,r=t.clientY-n.y,i=a/n.width*l,s=r/n.height*u;L.current.push({type:2,action:e,buttons:0,pointerId:BigInt(t.pointerId),pointerX:i,pointerY:s,pressure:65535*t.pressure,screenWidth:l,screenHeight:u})},[l,u]),N=Object(o.useCallback)(e=>{0===e.button&&T(0,e)},[T]),F=Object(o.useCallback)(e=>{1===e.buttons&&T(2,e)},[T]),B=Object(o.useCallback)(e=>{0===e.button&&T(1,e)},[T]),R=Object(o.useCallback)(e=>{},[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ut,{items:I,farItems:U}),c.a.createElement(mt,{ref:z,width:l,height:u},c.a.createElement("video",{ref:f,autoPlay:!0,width:l,height:u,onPointerDown:N,onPointerMove:F,onPointerUp:B,onKeyPress:R})),c.a.createElement(w.a,{hidden:!p,dialogContentProps:{title:"Connecting..."}},c.a.createElement(r.a,{tokens:fn},c.a.createElement(a.a,null,c.a.createElement(g.a,{label:"1. Downloading scrcpy server...",percentComplete:b?v/b:void 0,description:Et(k,b,O)})),c.a.createElement(a.a,null,c.a.createElement(g.a,{label:"2. Pushing scrcpy server to device...",progressHidden:0===b||v!==b,percentComplete:j/b,description:Et(C,b,x)})),c.a.createElement(a.a,null,c.a.createElement(g.a,{label:"3. Starting scrcpy server on device...",progressHidden:0===b||j!==b})))))});var xn=n("WDP9"),Dn=n("2WvF"),Ln=n("/POA"),An=n("R9As"),Pn=n("0fl0");n("q7KB");const _n={width:"100%",height:"100%"},zn={iconName:"ChevronUp"},In={iconName:"ChevronDown"},Un=ct("Shell")(({visible:e,device:t})=>{const{show:n}=Object(o.useContext)(jt),[i,s]=Object(o.useState)(""),l=Object(o.useRef)(),d=Object(o.useCallback)((e,t)=>{s(null!=t?t:""),t&&l.current.findNext(t,{incremental:!0})},[]),u=Object(o.useCallback)(()=>{l.current.findPrevious(i)},[i]),h=Object(o.useCallback)(()=>{l.current.findNext(i)},[i]),f=Object(o.useRef)(!1),p=Object(o.useRef)(),m=Object(o.useRef)(),b=Object(o.useRef)(),w=Object(o.useCallback)(async()=>{if(e&&t&&p.current&&!f.current)try{f.current=!0;const e=await t.shell();m.current=e,b.current=p.current.onData(t=>{const n=tt(t);e.write(n)}),e.onData(e=>{p.current.write(new Uint8Array(e))})}catch(e){n(e.message)}},[e,t]),g=Object(o.useRef)(w);g.current=w;const y=Object(o.useRef)(),v=Object(o.useCallback)(e=>{if(!e)return;const t=new Ln.Terminal({scrollback:9001});p.current=t;const n=new Pn.SearchAddon;l.current=n,t.loadAddon(n);const a=new An.FitAddon;y.current=a,t.loadAddon(a),t.open(e),a.fit(),g.current()},[]);Object(o.useEffect)(()=>{t?e&&!m.current&&g.current():m.current&&(b.current.dispose(),b.current=void 0,m.current.close(),m.current=void 0,p.current.clear(),p.current.reset(),f.current=!1)},[t,e]);const E=Object(o.useCallback)(()=>{var e;null===(e=y.current)||void 0===e||e.fit()},[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(a.a,null,c.a.createElement(r.a,{horizontal:!0},c.a.createElement(a.a,{grow:!0},c.a.createElement(xn.a,{placeholder:"Find",value:i,onChange:d,onSearch:h})),c.a.createElement(a.a,null,c.a.createElement(Dn.a,{disabled:!i,iconProps:zn,onClick:u})),c.a.createElement(a.a,null,c.a.createElement(Dn.a,{disabled:!i,iconProps:In,onClick:h})))),c.a.createElement(a.a,{grow:!0,styles:{root:{minHeight:0}}},c.a.createElement(pt,{style:_n,onResize:E},c.a.createElement("div",{ref:v,style:{height:"100%"}}))))});var Tn=n("GIx+"),Nn=n("tZOI"),Fn=n("CcL7");const Bn=ct("TcpIp")(({device:e})=>{const[t,n]=Object(o.useState)(),[r,i]=Object(o.useState)(!1),[s,l]=Object(o.useState)(""),[d,u]=Object(o.useState)(!1),[h,f]=Object(o.useState)(),p=Object(o.useCallback)(()=>{if(!e)return n(void 0),i(!1),l(""),u(!1),void f(void 0);(async()=>{const t=await e.getProp("service.adb.listen_addrs");n(t?t.split(","):void 0);const a=await e.getProp("service.adb.tcp.port");a?(i(!t&&"0"!==a),l(a)):(i(!1),l("5555"));const r=await e.getProp("persist.adb.tcp.port");r?(u(!t&&!a),f(r)):(u(!1),f(void 0))})()},[e]);Object(o.useEffect)(()=>{p()},[p]);const m=Object(o.useCallback)(()=>{e&&(async()=>{r?await e.tcpip.setPort(Number.parseInt(s,10)):await e.tcpip.disable()})()},[e,r,s]),b=Object(o.useMemo)(()=>[{key:"refresh",disabled:!e,iconProps:{iconName:"Refresh"},text:"Refresh",onClick:p},{key:"apply",disabled:!e,iconProps:{iconName:"Save"},text:"Apply",onClick:m}],[e,p,m]),w=Object(o.useCallback)((e,t)=>{i(!!t)},[]),g=Object(o.useCallback)((e,t)=>{void 0!==t&&l(t)},[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ut,{items:b}),c.a.createElement(a.a,null,c.a.createElement(Tn.a,null,c.a.createElement(sn.a,null,"Although WebADB can enable ADB over WiFi for you, it can't connect to your device wirelessly."))),c.a.createElement(a.a,null,c.a.createElement(Tn.a,null,c.a.createElement(sn.a,null,"Your device will disconnect after changing ADB over WiFi config."))),c.a.createElement(a.a,null,c.a.createElement(Nn.a,{inlineLabel:!0,label:"service.adb.listen_addrs",disabled:!0,checked:!!t,onText:"Enabled",offText:"Disabled"}),null==t?void 0:t.map(e=>c.a.createElement(Fn.a,{disabled:!0,value:e,styles:{root:{width:300}}}))),c.a.createElement(a.a,null,c.a.createElement(Nn.a,{inlineLabel:!0,label:"service.adb.tcp.port",checked:r,disabled:!e||!!t,onText:"Enabled",offText:"Disabled",onChange:w}),e&&c.a.createElement(Fn.a,{disabled:!!t,value:s,styles:{root:{width:300}},onChange:g})),c.a.createElement(a.a,null,c.a.createElement(Nn.a,{inlineLabel:!0,label:"persist.adb.tcp.port",disabled:!0,checked:d,onText:"Enabled",offText:"Disabled"}),h&&c.a.createElement(Fn.a,{disabled:!0,value:h,styles:{root:{width:300}}})))});Object(s.a)(),d.a.render(c.a.createElement(h.a,null,c.a.createElement(St,null,c.a.createElement((function(){const e=Object(u.e)(),[t,n]=Object(o.useState)(),s=Object(o.useMemo)(()=>{var e;return[{path:"/",exact:!0,name:"Introduction",children:c.a.createElement(dn,null)},{path:"/device-info",name:"Device Info",children:c.a.createElement(c.a.Fragment,null,c.a.createElement(a.a,null,"Product: ",null==t?void 0:t.product),c.a.createElement(a.a,null,"Model: ",null==t?void 0:t.model),c.a.createElement(a.a,null,"Device: ",null==t?void 0:t.device),c.a.createElement(a.a,null,"Features: ",null===(e=null==t?void 0:t.features)||void 0===e?void 0:e.join(",")))},{path:"/adb-over-wifi",name:"ADB over WiFi",children:c.a.createElement(Bn,{device:t})},{path:"/shell",name:"Interactive Shell",children:c.a.createElement(Un,{device:t})},{path:"/file-manager",name:"File Manager",children:c.a.createElement(nn,{device:t})},{path:"/framebuffer",name:"Screen Capture",children:c.a.createElement(an,{device:t})},{path:"/scrcpy",name:"Scrcpy",noCache:!0,children:c.a.createElement(Cn,{device:t})}]},[t]);return c.a.createElement(r.a,{verticalFill:!0},c.a.createElement(a.a,null,c.a.createElement("div",{style:{padding:"4px 0",fontSize:20,textAlign:"center",borderBottom:"1px solid rgb(243, 242, 241)"}},"WebADB Demo")),c.a.createElement(a.a,{grow:!0,styles:{root:{minHeight:0,overflow:"hidden"}}},c.a.createElement(r.a,{horizontal:!0,verticalFill:!0},c.a.createElement(a.a,{styles:{root:{paddingRight:8,borderRight:"1px solid rgb(243, 242, 241)"}}},c.a.createElement(xt,{device:t,onDeviceChange:n}),c.a.createElement(i.a,{styles:{root:{width:250}},groups:[{links:s.map(e=>({key:e.path,name:e.name,url:"#"+e.path}))}],selectedKey:e.pathname})),c.a.createElement(a.a,{grow:!0},c.a.createElement(Pt,null,s.map(e=>c.a.createElement(At,{exact:e.exact,path:e.path,noCache:e.noCache},e.children)),c.a.createElement(u.a,{to:"/"}))))))}),null))),document.getElementById("container"))}});
//# sourceMappingURL=index.3658e1472caade922c2e.js.map